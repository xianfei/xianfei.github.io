<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Tech on Xianfei's Blog</title><link>/en/categories/tech/</link><description>Recent content in Tech on Xianfei's Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Tue, 11 Jul 2023 00:00:00 +0000</lastBuildDate><atom:link href="/en/categories/tech/index.xml" rel="self" type="application/rss+xml"/><item><title>ã€è¯‘ã€‘GPT-4 Architecture, Infrastructure, Training Dataset, Costs,Vision, MoE</title><link>/en/p/gpt4/</link><pubDate>Tue, 11 Jul 2023 00:00:00 +0000</pubDate><guid>/en/p/gpt4/</guid><description>&lt;img src="/en/p/gpt4/banner.webp" alt="Featured image of post ã€è¯‘ã€‘GPT-4 Architecture, Infrastructure, Training Dataset, Costs,Vision, MoE" />&lt;p>Originalï¼šhttps://www.semianalysis.com/p/gpt-4-architecture-infrastructure&lt;/p>
&lt;p>Titleï¼šGPT-4 Architecture, Infrastructure, Training Dataset, Costs,Vision, MoE&lt;/p>
&lt;p>SubTitleï¼šDemystifying GPT-4: The engineering tradeoffs that led OpenAI to their architecture.&lt;/p>
&lt;h2 id="å‰è¨€--ç»¼è¿°">å‰è¨€ &amp;amp; ç»¼è¿°&lt;/h2>
&lt;p>OpenAI ä¿æŒ GPT-4 æ¶æ„çš„ç¥ç§˜æ„ŸåŠé—­æºå¹¶ä¸æ˜¯å› ä¸ºæ€•äººä»¬æ‹…å¿ƒå¯¹äººç±»å­˜åœ¨ä¸€äº›ç”Ÿå­˜é£é™©ï¼Œè€Œæ˜¯å› ä¸ºä»–ä»¬æ„å»ºçš„ä¸œè¥¿æ˜¯å¯å¤åˆ¶çš„ã€‚ äº‹å®ä¸Šï¼Œæˆ‘ä»¬é¢„è®¡ Googleã€Metaã€Anthropicã€Inflectionã€Characterã€è…¾è®¯ã€å­—èŠ‚è·³åŠ¨ã€ç™¾åº¦ç­‰åœ¨çŸ­æœŸå†…éƒ½å°†æ‹¥æœ‰ä¸ GPT-4 ä¸€æ ·å¼ºå¤§çš„æ¨¡å‹ã€‚&lt;/p>
&lt;p>ä¸è¦è¯¯ä¼šæˆ‘ä»¬çš„æ„æ€ï¼ŒOpenAI æ‹¥æœ‰ä»¤äººæƒŠå¹çš„å·¥ç¨‹ï¼Œä»–ä»¬æ„å»ºçš„ä¸œè¥¿ä»¤äººéš¾ä»¥ç½®ä¿¡ï¼Œä½†ä»–ä»¬å¾—å‡ºçš„è§£å†³æ–¹æ¡ˆå¹¶ä¸ç¥å¥‡ã€‚ è¿™æ˜¯ä¸€ä¸ªä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼Œå…·æœ‰è®¸å¤šå¤æ‚çš„æƒè¡¡ã€‚ åšå¤§åªæ˜¯æˆ˜æ–—çš„ä¸€éƒ¨åˆ†ã€‚ OpenAI æœ€æŒä¹…çš„æŠ¤åŸæ²³æ˜¯ä»–ä»¬åœ¨å…¨çƒèŒƒå›´å†…è¢«å¹¿æ³›ä½¿ç”¨ï¼ˆæ‹¥æœ‰å¤§é‡çš„æ•°æ®ï¼‰ã€é¢†å…ˆçš„å·¥ç¨‹äººæ‰ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡æœªæ¥çš„æ¨¡å‹ç»§ç»­é¢†å…ˆäºå…¶ä»–äººã€‚&lt;/p>
&lt;p>æˆ‘ä»¬ä»è®¸å¤šæ¥æºæ”¶é›†äº†å¤§é‡æœ‰å…³ GPT-4 çš„ä¿¡æ¯ï¼Œä»Šå¤©æˆ‘ä»¬æƒ³åˆ†äº«ä¸€ä¸‹ã€‚ è¿™åŒ…æ‹¬æ¨¡å‹æ¶æ„ã€è®­ç»ƒåŸºç¡€è®¾æ–½ã€æ¨ç†åŸºç¡€è®¾æ–½ã€å‚æ•°è®¡æ•°ã€è®­ç»ƒæ•°æ®é›†ç»„æˆã€tokenæ•°ã€å±‚æ•°ã€å¹¶è¡Œç­–ç•¥ã€å¤šæ¨¡æ€è§†è§‰é€‚é…ã€ä¸åŒå·¥ç¨‹æƒè¡¡èƒŒåçš„æ€ç»´è¿‡ç¨‹ã€ç‹¬ç‰¹çš„å®æ–½æŠ€æœ¯ä»¥åŠå®ƒä»¬å¦‚ä½•ç¼“è§£çŸ©å½¢æ¨¡å‹åœ¨æ¨ç†ä¸Šçš„å·¨å¤§ç“¶é¢ˆã€‚&lt;/p>
&lt;p>ç ”ç©¶ GPT-4 æœ€æœ‰è¶£çš„æ–¹é¢æ˜¯ï¼Œç†è§£ä»–ä»¬ä¸ºä»€ä¹ˆåšå‡ºæŸäº›æ¶æ„ä¸Šçš„å†³å®šã€‚&lt;/p>
&lt;p>æ­¤å¤–ï¼Œæˆ‘ä»¬å°†å¤§è‡´çŒœæµ‹ A100 ä¸Š GPT-4 çš„è®­ç»ƒå’Œæ¨ç†æˆæœ¬ï¼Œä»¥åŠå¦‚ä½•åœ¨ä¸‹ä¸€ä»£æ¨¡å‹æ¶æ„ä¸­ä¸ H100 è®¡ç®—å¡çš„æƒ…å†µä¸‹è¿›è¡Œè¿›ä¸€æ­¥çš„æ‰©å±•ã€‚&lt;/p>
&lt;p>é¦–å…ˆï¼Œä» GPT-3 åˆ° GPT-4ï¼ŒOpenAI å¸Œæœ›æ‰©å±• 100 å€ï¼Œä½†æˆæœ¬æ˜¯å¾ˆå¤§çš„é—®é¢˜ã€‚ Dense Transformers æ¨¡å‹å¾ˆéš¾è¿›ä¸€æ­¥æ‰©å¤§å‚æ•°é‡&lt;sup>1&lt;/sup>ã€‚ Dense Transformers æ˜¯ OpenAI GPT-3ã€Google PaLMã€Meta LLAMAã€TII Falconã€MosaicML MPT ç­‰ä½¿ç”¨çš„æ¨¡å‹æ¶æ„ã€‚ æˆ‘ä»¬å¯ä»¥è½»æ¾è¯´å‡º 50 å®¶ä½¿ç”¨ç›¸åŒæ¶æ„æ¥è®­ç»ƒLLMsï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰çš„å…¬å¸ã€‚ è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ï¼Œä½†å®ƒåœ¨&lt;strong>æ‰©å±•æ–¹é¢å­˜åœ¨ç¼ºé™·&lt;/strong>ã€‚&lt;/p>
&lt;p>ä»è®­ç»ƒæˆæœ¬çš„è§’åº¦æ¥çœ‹ï¼Œå¯ä»¥å‚é˜…æˆ‘ä»¬åœ¨ GPT-4 ä¹‹å‰å…³äºå³å°†æ¨å‡ºçš„å¯†é›†ï¼ˆåŒå‰æ–‡ä¸­çš„Denseï¼‰æ¨¡å‹&lt;strong>The AI Brick Wall&lt;/strong>çš„è®­ç»ƒæˆæœ¬è®¨è®º&lt;sup>1&lt;/sup>ã€‚ åœ¨é‚£é‡Œï¼Œæˆ‘ä»¬æ­ç¤ºäº† OpenAI åœ¨ GPT-4 æ¶æ„æ–¹é¢æ‰€åšçš„ high-level å·¥ä½œä»¥åŠå„ç§ç°æœ‰æ¨¡å‹çš„è®­ç»ƒæˆæœ¬ã€‚&lt;/p>
&lt;p>ä½†æ˜¯åœ¨è¿‡å»çš„ 6 ä¸ªæœˆé‡Œï¼Œæˆ‘ä»¬æ„è¯†åˆ°&lt;strong>è®­ç»ƒæˆæœ¬å¹¶ä¸æ˜¯ä¸€ä¸ªå†³å®šæ€§å› ç´ &lt;/strong>ï¼ˆirrelevantï¼‰ã€‚&lt;/p>
&lt;p>å½“ç„¶ï¼Œä»è¡¨é¢ä¸Šçœ‹ï¼ŒèŠ±è´¹æ•°åƒä¸‡ç”šè‡³æ•°äº¿ç¾å…ƒçš„è®¡ç®—æ—¶é—´æ¥è®­ç»ƒæ¨¡å‹ä¼¼ä¹å¾ˆç–¯ç‹‚ï¼Œä½†è¿™å¯¹äºè¿™äº›å…¬å¸æ¥è¯´æ˜¯å¾®ä¸è¶³é“çš„ã€‚ å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªèµ„æœ¬æ”¯å‡ºï¼ˆCapex lineï¼‰é¡¹ç›®ï¼Œè§„æ¨¡æ‰©å¤§å¯ä»¥æŒç»­å¸¦æ¥æ›´å¥½çš„ç»“æœã€‚ å”¯ä¸€çš„é™åˆ¶å› ç´ æ˜¯å°†è®¡ç®—æ‰©å±•åˆ°ä¸€ä¸ªæ—¶é—´å°ºåº¦ï¼Œä»¥ä¾¿äººç±»å¯ä»¥å¾—åˆ°åé¦ˆå¹¶ä¿®æ”¹æ¶æ„ã€‚&lt;/p>
&lt;p>æœªæ¥å‡ å¹´ï¼Œè°·æ­Œã€Metaã€OpenAI/å¾®è½¯ç­‰å¤šå®¶å…¬å¸å°†åœ¨ä»·å€¼è¶…è¿‡åƒäº¿ç¾å…ƒçš„è¶…çº§è®¡ç®—æœºä¸Šè®­ç»ƒæ¨¡å‹ã€‚ Meta æ¯å¹´åœ¨â€œå…ƒå®‡å®™ï¼ˆMetaverseï¼‰â€ä¸Šçƒ§äº†è¶…è¿‡ 160 äº¿ç¾å…ƒï¼ŒGoogle æ¯å¹´åœ¨å„ç§æ°¸è¿œä¸ä¼šå®ç°æˆæœçš„é¡¹ç›®ä¸Šæµªè´¹ 100 äº¿ç¾å…ƒã€‚ äºšé©¬é€Šåœ¨ Alexa ä¸ŠæŸå¤±äº†è¶…è¿‡ 50 äº¿ç¾å…ƒã€‚ åŠ å¯†è´§å¸åœ¨æ¯«æ— ä»·å€¼çš„æƒ…å†µä¸‹æµªè´¹äº†è¶…è¿‡ 1000 äº¿ç¾å…ƒ&lt;/p>
&lt;p>è¿™äº›å…¬å¸å’Œå…¶ä»–ç»„ç»‡å¯ä»¥è€Œä¸”å°†ä¼šèŠ±è´¹è¶…è¿‡ä¸€åƒäº¿ç¾å…ƒæ¥åˆ›å»ºå¯ä»¥è®­ç»ƒå•ä¸ªå¤§è§„æ¨¡æ¨¡å‹çš„è¶…çº§è®¡ç®—æœºã€‚ ç„¶åå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å°†è¿™äº›å¤§å‹æ¨¡å‹äº§å“åŒ–ã€‚è¿™é¡¹å·¥ä½œå°†åœ¨å¤šä¸ªå›½å®¶å’Œå…¬å¸é‡å¤è¿›è¡Œã€‚ è¿™æ˜¯æ–°çš„å†›å¤‡ç«èµ›ã€‚ ä»¥å‰çš„æµªè´¹ä¸ç°åœ¨çš„åŒºåˆ«åœ¨äºï¼Œäººå·¥æ™ºèƒ½å¯ä»¥åœ¨å–ä»£éƒ¨åˆ†äººç±»çš„å·¥ä½œä¸ŠçŸ­æœŸå†…å¸¦æ¥æœ‰å½¢çš„ä»·å€¼ã€‚&lt;/p>
&lt;p>æ‰©å±•äººå·¥æ™ºèƒ½ï¼ˆçœŸæ­£çš„äººå·¥æ™ºèƒ½ç –å¢™ï¼‰çš„æ›´é‡è¦é—®é¢˜æ˜¯&lt;strong>æ¨ç†&lt;/strong>ã€‚ ç›®æ ‡æ˜¯å°†è®­ç»ƒè®¡ç®—ä¸æ¨ç†è®¡ç®—åˆ†ç¦»ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè®­ç»ƒ Chinchilla å¯¹äºä»»ä½•å°†è¦éƒ¨ç½²çš„æ¨¡å‹æ¥è¯´éƒ½æ˜¯æœ€ä½³çš„ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦è¿›è¡Œç¨€ç–æ¨¡å‹æ¶æ„ï¼› å¹¶ä¸æ˜¯æ¯ä¸ªå‚æ•°åœ¨æ¨ç†è¿‡ç¨‹ä¸­éƒ½ä¼šè¢«ä½¿ç”¨åˆ°ã€‚&lt;/p>
&lt;p>çœŸæ­£çš„æ£˜æ‰‹çš„é—®é¢˜è¿™äº›æ¨¡å‹çš„ç”¨æˆ·&lt;strong>ä½¿ç”¨çš„æˆæœ¬å¤ªé«˜&lt;/strong>ã€‚æ¨ç†æˆæœ¬æ˜¯è®­ç»ƒæˆæœ¬çš„æ•°å€ã€‚è¿™å°±æ˜¯OpenAIåœ¨æ¨¡å‹æ¶æ„å’ŒåŸºç¡€è®¾æ–½æ–¹é¢çš„åˆ›æ–°ç›®æ ‡ã€‚&lt;/p>
&lt;p>å¤§å‹æ¨¡å‹çš„æ¨ç†æ˜¯ä¸€ä¸ªå¤šå˜é‡é—®é¢˜ï¼Œåœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œå¯†é›†æ¨¡å‹çš„æ¨¡å‹å¤§å°ä¼šæˆä¸ºè‡´å‘½çš„é—®é¢˜ã€‚æˆ‘ä»¬å·²ç»åœ¨è¿™é‡Œ&lt;sup>2&lt;/sup>è¯¦ç»†è®¨è®ºäº†å…³äºè¾¹ç¼˜è®¡ç®—çš„é—®é¢˜ï¼Œä½†å¯¹äºæ•°æ®ä¸­å¿ƒæ¥è¯´ï¼Œé—®é¢˜æ˜¯éå¸¸ç›¸ä¼¼çš„ã€‚ç®€è¦æ¦‚è¿°å°±æ˜¯ï¼Œè®¾å¤‡æ°¸è¿œæ— æ³•æ‹¥æœ‰è¶³å¤Ÿçš„å†…å­˜å¸¦å®½æ¥è®©å¤§å‹è¯­è¨€æ¨¡å‹è¾¾åˆ°ä¸€å®šç¨‹åº¦çš„ååé‡ã€‚å³ä½¿å®ƒä»¬æ‹¥æœ‰è¶³å¤Ÿçš„å¸¦å®½ï¼Œè¾¹ç¼˜è®¡ç®—ä¸Šç¡¬ä»¶è®¡ç®—èµ„æºçš„åˆ©ç”¨ç‡ä¹Ÿä¼šéå¸¸ä½ã€‚&lt;/p>
&lt;p>åœ¨æ•°æ®ä¸­å¿ƒå’Œäº‘ç«¯ï¼Œåˆ©ç”¨ç‡æ˜¯è‡³å…³é‡è¦çš„ã€‚Nvidiaå› è½¯ä»¶ä¼˜è¶Šæ€§è€Œå—åˆ°èµèª‰çš„ä¸€åŠåŸå› æ˜¯ï¼Œåœ¨GPUçš„å‡ ä»£ç”Ÿå‘½å‘¨æœŸä¸­ï¼ŒNvidiaä¸æ–­æ›´æ–°åº•å±‚è½¯ä»¶ï¼Œé€šè¿‡æ›´æ™ºèƒ½åœ°åœ¨èŠ¯ç‰‡å†…ã€èŠ¯ç‰‡ä¹‹é—´ä»¥åŠå†…å­˜ä¹‹é—´ç§»åŠ¨æ•°æ®ï¼Œä»è€Œæé«˜FLOPSåˆ©ç”¨ç‡ã€‚&lt;/p>
&lt;p>åœ¨å¤§å¤šæ•°å½“å‰çš„åº”ç”¨åœºæ™¯ä¸­ï¼ŒLLMæ¨ç†çš„ä½œç”¨æ˜¯ä½œä¸ºå®æ—¶åŠ©æ‰‹ï¼Œè¿™æ„å‘³ç€å®ƒå¿…é¡»å®ç°è¶³å¤Ÿé«˜çš„ååé‡ï¼Œä»¥ä¾¿ç”¨æˆ·å®é™…ä½¿ç”¨ã€‚äººç±»å¹³å‡æ¯åˆ†é’Ÿé˜…è¯»é€Ÿåº¦çº¦ä¸º250ä¸ªå•è¯ï¼Œä½†æœ‰äº›äººçš„é˜…è¯»é€Ÿåº¦é«˜è¾¾æ¯åˆ†é’Ÿ1000ä¸ªå•è¯ã€‚è¿™æ„å‘³ç€ä½ éœ€è¦æ¯ç§’è¾“å‡ºè‡³å°‘8.33ä¸ª token ï¼ˆtokensï¼‰ï¼Œä½†æ¯ç§’è¾“å‡º33.33ä¸ª token æ‰èƒ½è¦†ç›–æ‰€æœ‰æç«¯æƒ…å†µã€‚&lt;/p>
&lt;p>ç”±äºå†…å­˜å¸¦å®½è¦æ±‚ï¼Œå³ä½¿åœ¨æœ€æ–°çš„Nvidia H100 GPUæœåŠ¡å™¨ä¸Šï¼Œä¸€ä¸ªæ‹¥æœ‰ä¸‡äº¿å‚æ•°çš„å¯†é›†å‹æ¨¡å‹ä¹Ÿæ— æ³•å®ç°è¿™ç§ååé‡ã€‚æ¯ç”Ÿæˆä¸€ä¸ª token ï¼Œéƒ½éœ€è¦å°†æ¯ä¸ªå‚æ•°ä»å†…å­˜åŠ è½½åˆ°èŠ¯ç‰‡ä¸Šã€‚ç„¶åå°†ç”Ÿæˆçš„ token è¾“å…¥åˆ°æç¤ºä¸­ï¼Œå¹¶ç”Ÿæˆä¸‹ä¸€ä¸ª token ã€‚æ­¤å¤–ï¼Œè¿˜éœ€è¦é¢å¤–çš„å¸¦å®½æ¥ä¸ºæ³¨æ„åŠ›æœºåˆ¶ä¸­çš„KVç¼“å­˜è¿›è¡Œæµå¼ä¼ è¾“ã€‚&lt;/p>
&lt;p>&lt;img src="../../../en/p/gpt4/1.webp"
width="2520"
height="1026"
srcset="../../../en/p/gpt4/1_hu82888187263a020a367fc2084d410b90_68910_480x0_resize_q60_h2_box_2.webp 480w, ../../../en/p/gpt4/1_hu82888187263a020a367fc2084d410b90_68910_1536x0_resize_q60_h2_box_2.webp 1536w"
loading="lazy"
class="gallery-image"
data-flex-grow="245"
data-flex-basis="589px"
>&lt;/p>
&lt;blockquote>
&lt;p>å›¾æ³¨ï¼šè¯¥å›¾è¡¨å‡è®¾ç”±äºæ— æ³•èåˆæ¯ä¸ªæ“ä½œã€æ³¨æ„åŠ›æœºåˆ¶æ‰€éœ€çš„å†…å­˜å¸¦å®½å’Œç¡¬ä»¶å¼€é”€ç­‰ä½æ•ˆé—®é¢˜ï¼Œç­‰åŒäºå‚æ•°è¯»å–ã€‚å®é™…ä¸Šï¼Œå³ä½¿ä½¿ç”¨åƒè‹±ä¼Ÿè¾¾çš„FasterTransformeråº“è¿™æ ·çš„â€œä¼˜åŒ–â€åº“ï¼Œæ€»å¼€é”€ç”šè‡³æ›´å¤§ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ä¸Šå›¾å±•ç¤ºäº†ä¸ºäº†ä»¥è¶³å¤Ÿé«˜çš„ååé‡ä¸ºå•ä¸ªç”¨æˆ·æä¾›LLMæ¨æ–­æœåŠ¡æ‰€éœ€çš„å†…å­˜å¸¦å®½ã€‚å®ƒè¡¨æ˜ï¼Œå³ä½¿æ˜¯8ä¸ª H100 ä¹Ÿæ— æ³•åœ¨æ¯ç§’33.33ä¸ª token çš„é€Ÿåº¦ä¸‹ä¸º1ä¸‡äº¿å‚æ•°çš„å¯†é›†æ¨¡å‹æä¾›æœåŠ¡ã€‚æ­¤å¤–ï¼Œåœ¨æ¯ç§’20ä¸ª token çš„é€Ÿåº¦ä¸‹ï¼Œ8xH100çš„FLOPSåˆ©ç”¨ç‡ä»ç„¶ä½äº5%ï¼Œå¯¼è‡´æ¨æ–­æˆæœ¬æé«˜ã€‚å®é™…ä¸Šï¼Œå¯¹äºç›®å‰çš„8è·¯å¼ é‡å¹¶è¡ŒH100ç³»ç»Ÿï¼Œæ¨æ–­çº¦æŸåœ¨çº¦3000äº¿å‰é¦ˆå‚æ•°å·¦å³ã€‚&lt;/p>
&lt;p>ç„¶è€Œï¼ŒOpenAIä½¿ç”¨A100å®ç°äº†äººç±»é˜…è¯»é€Ÿåº¦ï¼Œå¹¶ä½¿ç”¨äº†è¶…è¿‡1ä¸‡äº¿å‚æ•°çš„æ¨¡å‹ï¼Œè€Œä¸”ä»–ä»¬ä»¥æ¯1000ä¸ª token ä»…0.06ç¾å…ƒçš„ä½ä»·å¹¿æ³›æä¾›ã€‚è¿™æ˜¯å› ä¸ºå®ƒæ˜¯ç¨€ç–çš„ï¼Œå³å¹¶éæ¯ä¸ªå‚æ•°éƒ½è¢«ä½¿ç”¨ã€‚&lt;/p>
&lt;p>å…³äºGPT-4æ¨¡å‹æ¶æ„ã€è®­ç»ƒåŸºç¡€è®¾æ–½ã€æ¨æ–­åŸºç¡€è®¾æ–½ã€å‚æ•°æ•°é‡ã€è®­ç»ƒæ•°æ®é›†ç»„æˆã€ token æ•°é‡ã€å±‚æ•°ã€å¹¶è¡Œç­–ç•¥ã€å¤šæ¨¡æ€è§†è§‰ç¼–ç å™¨ã€ä¸åŒå·¥ç¨‹æƒè¡¡èƒŒåçš„æ€è€ƒè¿‡ç¨‹ã€ç‹¬ç‰¹å®æ–½æŠ€æœ¯ä»¥åŠå¦‚ä½•å‡è½»ä¸å·¨å‹æ¨¡å‹æ¨æ–­ç›¸å…³çš„ä¸€äº›æœ€å¤§ç“¶é¢ˆçš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¸å†æ‹–æ³¥å¸¦æ°´ï¼Œç›´æ¥è¿›å…¥ä¸»é¢˜ã€‚&lt;/p>
&lt;h2 id="æ¨¡å‹æ¶æ„-model-architecture">æ¨¡å‹æ¶æ„ Model Architecture&lt;/h2>
&lt;p>GPT-4çš„å¤§å°æ˜¯GPT-3çš„10å€ä»¥ä¸Šã€‚æˆ‘ä»¬è®¤ä¸ºå®ƒåœ¨120ä¸ªå±‚æ¬¡ä¸Šæ‹¥æœ‰çº¦1.8ä¸‡äº¿ä¸ªå‚æ•°ï¼Œè€ŒGPT-3çš„å‚æ•°çº¦ä¸º1750äº¿ä¸ªã€‚&lt;/p>
&lt;p>OpenAIé€šè¿‡ä½¿ç”¨ä¸“å®¶æ··åˆï¼ˆMoE, mixture of expertsï¼‰æ¨¡å‹æ¥ä¿æŒæˆæœ¬åˆç†ã€‚å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰MoEï¼Œè¯·é˜…è¯»æˆ‘ä»¬6ä¸ªæœˆå‰å…³äºå¹¿ä¹‰GPT-4æ¶æ„å’Œè®­ç»ƒæˆæœ¬çš„æ–‡ç« ã€‚&lt;/p>
&lt;p>æ­¤å¤–ï¼ŒOpenAIåœ¨å…¶æ¨¡å‹ä¸­ä½¿ç”¨äº†16ä¸ªä¸“å®¶æ¨¡å‹ï¼Œæ¯ä¸ªä¸“å®¶æ¨¡å‹çš„MLPå‚æ•°çº¦ä¸º1110äº¿ä¸ªã€‚å…¶ä¸­æœ‰2ä¸ªä¸“å®¶æ¨¡å‹è¢«è·¯ç”±åˆ°æ¯ä¸ªå‰å‘ä¼ é€’ä¸­ã€‚&lt;/p>
&lt;p>è™½ç„¶æ–‡çŒ®ä¸­è°ˆåˆ°äº†å¾ˆå¤šé«˜çº§è·¯ç”±ç®—æ³•ï¼Œç”¨äºé€‰æ‹©å°†æ¯ä¸ª token è·¯ç”±åˆ°å“ªä¸ªä¸“å®¶ï¼Œä½†OpenAIçš„è·¯ç”±ç®—æ³•æ®ç§°å¯¹äºå½“å‰çš„GPT-4æ¨¡å‹æ¥è¯´ç›¸å½“ç®€å•ã€‚æ­¤å¤–ï¼Œæ³¨æ„åŠ›ï¼ˆæ­¤å¤„æŒ‡Transformerçš„Attentionï¼‰çº¦æœ‰550äº¿ä¸ªå…±äº«çš„å‚æ•°ã€‚&lt;/p>
&lt;p>æ¯ä¸ªå‰å‘ä¼ é€’æ¨æ–­ï¼ˆç”Ÿæˆ1ä¸ª token ï¼‰ä»…ä½¿ç”¨çº¦2800äº¿ä¸ªå‚æ•°å’Œçº¦560 TFLOPã€‚è¿™ä¸çº¯å¯†é›†æ¨¡å‹æ¯ä¸ªå‰å‘ä¼ é€’æ‰€éœ€çš„çº¦1.8ä¸‡äº¿ä¸ªå‚æ•°å’Œçº¦3700 TFLOPå½¢æˆé²œæ˜å¯¹æ¯”ã€‚&lt;/p>
&lt;h2 id="æ•°æ®é›†æ„æˆ-dataset-composition">æ•°æ®é›†æ„æˆ Dataset Composition&lt;/h2>
&lt;p>OpenAI åœ¨å¤§çº¦ 13 ä¸‡äº¿ä¸ª tokens çš„æ•°æ®é›†ä¸Šè®­ç»ƒäº† GPT-4ã€‚å…¶ä¸­ CommonCrawl RefinedWeb åŒ…å«å¤§çº¦ 5 ä¸‡äº¿ä¸ªé«˜è´¨é‡ tokensã€‚ä½œä¸ºå‚è€ƒï¼ŒDeepmind çš„ Chinchilla å’Œ Google çš„ PaLM æ¨¡å‹åˆ†åˆ«åœ¨å¤§çº¦ 1.4 ä¸‡äº¿ tokens å’Œå¤§çº¦ 0.78 ä¸‡äº¿ tokens ä¸Šè¿›è¡Œäº†è®­ç»ƒã€‚ç”šè‡³æ®ç§° PaLM 2 ä¹Ÿåœ¨å¤§çº¦ 5 ä¸‡äº¿ tokens ä¸Šè¿›è¡Œäº†è®­ç»ƒã€‚&lt;/p>
&lt;blockquote>
&lt;p>CommonCrawl æ˜¯ä¸€ä¸ªéè¥åˆ©ç»„ç»‡ï¼Œå®ƒå®šæœŸä»äº’è”ç½‘ä¸ŠæŠ“å–å’Œå­˜å‚¨ç½‘é¡µæ•°æ®ã€‚å®ƒæä¾›ä¸€ä¸ªåŒ…å«æ•°åäº¿ä¸ªç½‘é¡µçš„å¤§å‹å…¬å…±æ•°æ®é›†ï¼Œè¿™äº›ç½‘é¡µæ¥è‡ªäºå…¨çƒå„åœ°çš„å¤šç§è¯­è¨€ã€‚è¿™ä¸ªæ•°æ®é›†å¯¹äºç ”ç©¶äººå‘˜ã€å¼€å‘è€…å’Œä¼ä¸šæ¥è¯´éå¸¸æœ‰ä»·å€¼ï¼Œå› ä¸ºå®ƒå¯ä»¥ç”¨äºè®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œä¾‹å¦‚è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ä»»åŠ¡ï¼Œä»¥åŠè¿›è¡Œå…¶ä»–å¤§æ•°æ®åˆ†æã€‚åœ¨æœ¬æ–‡ä¸­ï¼ŒCommonCrawl ç”¨äºæä¾›å¤§é‡é«˜è´¨é‡ tokensï¼Œä»¥ä¾¿åœ¨è®­ç»ƒ GPT-4 æ—¶ä½¿ç”¨ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>è¿™ä¸ªæ•°æ®é›†å¹¶é 13 ä¸‡äº¿ä¸ªç‹¬ç‰¹çš„ tokensã€‚ç›¸åï¼Œç”±äºç¼ºä¹é«˜è´¨é‡ tokensï¼Œæ•°æ®é›†åŒ…å«äº†å¤šä¸ªæ—¶æœŸã€‚æ–‡æœ¬æ•°æ®æœ‰ 2 ä¸ªæ—¶æœŸï¼Œä»£ç æ•°æ®æœ‰ 4 ä¸ªæ—¶æœŸã€‚æœ‰è¶£çš„æ˜¯ï¼Œè¿™è¿œè¿œä½äº Chinchilla çš„æœ€ä¼˜å€¼ï¼Œè¡¨æ˜éœ€è¦åœ¨åŒå€çš„ token æ•°é‡ä¸Šè®­ç»ƒæ¨¡å‹ã€‚è¿™è¡¨æ˜ç½‘ç»œä¸Šç¼ºä¹æ˜“äºè·å–çš„ tokensã€‚å®é™…ä¸Šå­˜åœ¨ç€ 1000 å€ä»¥ä¸Šçš„é«˜è´¨é‡æ–‡æœ¬ tokensï¼Œç”šè‡³è¿˜æœ‰æ›´å¤šçš„éŸ³é¢‘å’Œè§†è§‰ tokensï¼Œä½†è·å–å®ƒä»¬å¹¶ä¸åƒç½‘ç»œæŠ“å–é‚£æ ·ç®€å•ã€‚&lt;/p>
&lt;p>è¿˜æœ‰æ¥è‡ª ScaleAI å’Œå†…éƒ¨çš„æ•°ç™¾ä¸‡è¡ŒæŒ‡ä»¤å¾®è°ƒæ•°æ®ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬æ²¡æœ‰æ‰¾åˆ°å…³äºä»–ä»¬ RLHF æ•°æ®çš„æ›´å¤šä¿¡æ¯ã€‚é¢„è®­ç»ƒé˜¶æ®µæœ‰ 8k çš„ä¸Šä¸‹æ–‡é•¿åº¦ï¼ˆseqlenï¼‰ã€‚GPT-4 çš„ 32k seqlen ç‰ˆæœ¬æ˜¯åŸºäºé¢„è®­ç»ƒåçš„ 8k è¿›è¡Œå¾®è°ƒçš„ã€‚&lt;/p>
&lt;p>åœ¨é›†ç¾¤ä¸Šï¼Œæ‰¹é‡å¤§å°åœ¨æ•°å¤©å†…é€æ¸å¢åŠ ï¼Œä½†æœ€åï¼ŒOpenAI ä½¿ç”¨äº†ä¸€ä¸ªæ‰¹é‡å¤§å°ä¸º 6000 ä¸‡ï¼å½“ç„¶ï¼Œç”±äºå¹¶éæ¯ä¸ªä¸“å®¶éƒ½èƒ½çœ‹åˆ°æ‰€æœ‰ tokensï¼Œè¿™åªæ˜¯æ¯ä½ä¸“å®¶çš„ 750 ä¸‡ tokens çš„â€œä»…ä»…â€ä¸€ä¸ªæ‰¹æ¬¡å¤§å°ã€‚&lt;/p>
&lt;h2 id="å¹¶è¡Œç­–ç•¥-parallelism-strategies">å¹¶è¡Œç­–ç•¥ Parallelism Strategies&lt;/h2>
&lt;p>èƒ½å¤Ÿåˆ©ç”¨æ‰€æœ‰A100 GPUçš„å¹¶è¡Œç­–ç•¥è‡³å…³é‡è¦ã€‚ä»–ä»¬åˆ©ç”¨äº†8è·¯å¼ é‡å¹¶è¡Œï¼Œå› ä¸ºè¿™æ˜¯NVLinkçš„æé™ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬å¬è¯´ä»–ä»¬æ­£åœ¨ä½¿ç”¨15è·¯æµæ°´çº¿å¹¶è¡Œã€‚ä»ç†è®ºä¸Šè®²ï¼Œè€ƒè™‘åˆ°æ•°æ®é€šä¿¡ä¸è®¡ç®—æ—¶é—´ï¼Œè¿™æ˜¯è¿‡å¤šçš„æµæ°´çº¿ï¼Œä½†å¦‚æœä»–ä»¬å—åˆ°å†…å­˜å®¹é‡çš„é™åˆ¶ï¼Œé‚£ä¹ˆè¿™æ˜¯æœ‰é“ç†çš„ã€‚&lt;/p>
&lt;p>åœ¨çº¯ç²¹çš„æµæ°´çº¿+å¼ é‡å¹¶è¡Œçš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªGPUåœ¨FP16ä¸‹ä»…å‚æ•°å°±éœ€è¦çº¦30GBã€‚ä¸€æ—¦åŠ ä¸ŠKVç¼“å­˜å’Œå¼€é”€ï¼Œå¦‚æœOpenAIçš„å¤§éƒ¨åˆ†GPUéƒ½æ˜¯40GB A100ï¼Œé‚£ä¹ˆä»ç†è®ºä¸Šè®²è¿™æ˜¯æœ‰é“ç†çš„ã€‚ä»–ä»¬å¯èƒ½ä½¿ç”¨äº†ZeRoé˜¶æ®µ1ã€‚ä»–ä»¬å¯èƒ½ä½¿ç”¨äº†å—çº§FSDPï¼ˆå…¨åˆ†å¸ƒå¼çŠ¶æ€å¹¶è¡Œï¼‰æˆ–æ··åˆå…±äº«æ•°æ®å¹¶è¡Œã€‚&lt;/p>
&lt;blockquote>
&lt;p>ZeRoï¼ˆZero Redundancy Optimizerï¼Œé›¶å†—ä½™ä¼˜åŒ–å™¨ï¼‰æ˜¯ä¸€ç§ç”¨äºé™ä½æ·±åº¦å­¦ä¹ è®­ç»ƒä¸­å†…å­˜éœ€æ±‚çš„æŠ€æœ¯ã€‚ZeRo Stage 1 æ˜¯è¿™ä¸ªä¼˜åŒ–ç­–ç•¥çš„ç¬¬ä¸€é˜¶æ®µã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œä¼˜åŒ–å™¨çŠ¶æ€å’Œæ¢¯åº¦è¢«åˆ†å¸ƒå¼å­˜å‚¨åœ¨å¤šä¸ª GPU æˆ–è®¾å¤‡ä¸Šï¼Œä»è€Œå‡å°‘äº†æ¯ä¸ªè®¾å¤‡çš„å†…å­˜å ç”¨ã€‚è¿™ä½¿å¾—åœ¨æœ‰é™çš„ç¡¬ä»¶èµ„æºä¸‹è®­ç»ƒæ›´å¤§çš„æ¨¡å‹æˆä¸ºå¯èƒ½ã€‚&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>FSDPï¼ˆFully Sharded Data Parallelï¼Œå…¨åˆ†å¸ƒå¼çŠ¶æ€å¹¶è¡Œï¼‰å’Œæ··åˆå…±äº«æ•°æ®å¹³è¡Œï¼ˆHybrid Shared Data Parallelï¼‰éƒ½æ˜¯ç”¨äºåŠ é€Ÿæ·±åº¦å­¦ä¹ è®­ç»ƒçš„å¹¶è¡Œè®¡ç®—ç­–ç•¥ï¼Œä½†å®ƒä»¬çš„å®ç°å’Œå…³æ³¨ç‚¹æœ‰æ‰€ä¸åŒã€‚&lt;/p>
&lt;p>FSDP æ˜¯ä¸€ç§å°†æ¨¡å‹å‚æ•°ã€ä¼˜åŒ–å™¨çŠ¶æ€å’Œæ¢¯åº¦åœ¨å¤šä¸ªè®¾å¤‡ï¼ˆå¦‚ GPUï¼‰ä¹‹é—´åˆ†ç‰‡çš„æŠ€æœ¯ã€‚é€šè¿‡å°†è¿™äº›çŠ¶æ€åˆ†å¸ƒåœ¨ä¸åŒçš„è®¾å¤‡ä¸Šï¼ŒFSDP å¯ä»¥é™ä½æ¯ä¸ªè®¾å¤‡çš„å†…å­˜éœ€æ±‚ï¼Œä»è€Œä½¿å¾—åœ¨æœ‰é™çš„ç¡¬ä»¶èµ„æºä¸‹è®­ç»ƒæ›´å¤§çš„æ¨¡å‹æˆä¸ºå¯èƒ½ã€‚FSDP è¿˜å¯ä»¥ä¸å…¶ä»–å¹¶è¡Œç­–ç•¥ï¼ˆå¦‚æ¨¡å‹å¹¶è¡Œå’Œæµæ°´çº¿å¹¶è¡Œï¼‰ç»“åˆä½¿ç”¨ï¼Œä»¥è¿›ä¸€æ­¥æé«˜è®­ç»ƒé€Ÿåº¦å’Œæ‰©å±•æ€§ã€‚&lt;/p>
&lt;p>æ··åˆå…±äº«æ•°æ®å¹³è¡Œï¼ˆHybrid Shared Data Parallelï¼‰æ˜¯ä¸€ç§ç»“åˆäº†æ•°æ®å¹¶è¡Œå’Œæ¨¡å‹å¹¶è¡Œçš„ç­–ç•¥ã€‚åœ¨æ•°æ®å¹¶è¡Œä¸­ï¼Œæ¯ä¸ªè®¾å¤‡éƒ½æœ‰ä¸€ä¸ªå®Œæ•´çš„æ¨¡å‹å‰¯æœ¬ï¼Œå¹¶åœ¨ä¸åŒçš„æ•°æ®å­é›†ä¸Šè¿›è¡Œè®­ç»ƒã€‚åœ¨æ¨¡å‹å¹¶è¡Œä¸­ï¼Œæ¨¡å‹è¢«åˆ’åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†åˆ†å¸ƒåœ¨ä¸åŒçš„è®¾å¤‡ä¸Šã€‚æ··åˆå…±äº«æ•°æ®å¹³è¡Œæ—¨åœ¨å……åˆ†åˆ©ç”¨è¿™ä¸¤ç§ç­–ç•¥çš„ä¼˜ç‚¹ï¼Œé€šè¿‡å°†æ¨¡å‹å‚æ•°å’Œè®¡ç®—åœ¨å¤šä¸ªè®¾å¤‡ä¸Šå…±äº«ï¼Œæ¥æé«˜è®­ç»ƒé€Ÿåº¦å’Œæ‰©å±•æ€§ã€‚&lt;/p>
&lt;p>æ€»ä¹‹ï¼ŒFSDP å’Œæ··åˆå…±äº«æ•°æ®å¹³è¡Œéƒ½æ˜¯ä¸ºäº†åŠ é€Ÿæ·±åº¦å­¦ä¹ è®­ç»ƒè€Œè®¾è®¡çš„å¹¶è¡Œè®¡ç®—ç­–ç•¥ï¼Œä½†å®ƒä»¬å…³æ³¨çš„ä¼˜åŒ–æ–¹å‘å’Œå®ç°æ–¹å¼æœ‰æ‰€ä¸åŒã€‚FSDP ä¸»è¦å…³æ³¨é™ä½å†…å­˜éœ€æ±‚ï¼Œè€Œæ··åˆå…±äº«æ•°æ®å¹³è¡Œåˆ™å…³æ³¨åœ¨å¤šä¸ªè®¾å¤‡ä¸Šå…±äº«æ¨¡å‹å‚æ•°å’Œè®¡ç®—ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>è‡³äºä¸ºä»€ä¹ˆä»–ä»¬æ²¡æœ‰ä½¿ç”¨å®Œæ•´æ¨¡å‹çš„FSDPï¼Œå¯èƒ½æ˜¯å› ä¸ºè¾ƒé«˜çš„é€šä¿¡å¼€é”€ã€‚è™½ç„¶OpenAIåœ¨å¤§å¤šæ•°èŠ‚ç‚¹ä¹‹é—´å…·æœ‰é«˜é€Ÿç½‘ç»œè¿æ¥ï¼Œä½†å¯èƒ½å¹¶éæ‰€æœ‰èŠ‚ç‚¹ä¹‹é—´éƒ½å…·æœ‰è¿™ç§è¿æ¥ã€‚æˆ‘ä»¬è®¤ä¸ºè‡³å°‘æœ‰ä¸€äº›é›†ç¾¤çš„è¿æ¥å¸¦å®½è¿œä½äºå…¶ä»–é›†ç¾¤ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬ä¸æ˜ç™½ä»–ä»¬å¦‚ä½•é¿å…åœ¨å¦‚æ­¤é«˜çš„æµæ°´çº¿å¹¶è¡Œä¸­çš„æ¯ä¸ªæ‰¹æ¬¡éƒ½æœ‰å·¨å¤§çš„æ³¡æ²«ã€‚ä»–ä»¬å¯èƒ½åªæ˜¯æ‰¿æ‹…äº†æˆæœ¬ã€‚&lt;/p>
&lt;p>&lt;img src="../../../en/p/gpt4/2.webp"
width="1904"
height="884"
srcset="../../../en/p/gpt4/2_hu8a7ce8dc2e7cc52e87d9fafc09ef2b6a_33952_480x0_resize_q60_h2_box_2.webp 480w, ../../../en/p/gpt4/2_hu8a7ce8dc2e7cc52e87d9fafc09ef2b6a_33952_1536x0_resize_q60_h2_box_2.webp 1536w"
loading="lazy"
class="gallery-image"
data-flex-grow="215"
data-flex-basis="516px"
>&lt;/p>
&lt;h2 id="è®­ç»ƒæˆæœ¬--training-cost">è®­ç»ƒæˆæœ¬ Training Cost&lt;/h2>
&lt;p>OpenAIçš„GPT-4è®­ç»ƒæµ®ç‚¹è¿ç®—æ¬¡æ•°çº¦ä¸º2.15e25ï¼Œåœ¨å¤§çº¦25,000ä¸ªA100ä¸Šè¿›è¡Œ90åˆ°100å¤©ï¼Œå…¶MFUï¼ˆæœºå™¨åˆ©ç”¨ç‡ï¼‰çº¦ä¸º32%è‡³36%ã€‚è¿™ç§æä½çš„åˆ©ç”¨ç‡éƒ¨åˆ†åŸå› æ˜¯ç”±äºå¤§é‡çš„æ•…éšœï¼Œéœ€è¦ä»æ£€æŸ¥ç‚¹é‡æ–°å¯åŠ¨ã€‚ä¸Šè¿°æåˆ°çš„æ³¡æ²«æˆæœ¬éå¸¸é«˜ã€‚&lt;/p>
&lt;p>å¦ä¸€ä¸ªåŸå› æ˜¯åœ¨å¦‚æ­¤å¤šçš„GPUä¹‹é—´è¿›è¡Œall-reduceæ“ä½œéå¸¸è€—è´¹èµ„æºã€‚è¿™å°¤å…¶æ˜¯åœ¨æˆ‘ä»¬æ€€ç–‘é›†ç¾¤å®é™…ä¸Šæ˜¯ç”±ä¸€å †è¾ƒå°çš„é›†ç¾¤ç»„æˆï¼Œå®ƒä»¬ä¹‹é—´çš„ç½‘ç»œè¿æ¥è¾ƒå¼±çš„æƒ…å†µä¸‹ã€‚ä¾‹å¦‚ï¼Œåœ¨é›†ç¾¤çš„å„ä¸ªéƒ¨åˆ†ä¹‹é—´æœ‰800G/1.6Tçš„éé˜»å¡è¿æ¥ï¼Œä½†è¿™äº›éƒ¨åˆ†ä¹‹é—´åªæœ‰200G/400Gçš„è¿æ¥ã€‚&lt;/p>
&lt;blockquote>
&lt;p>æ–‡ä¸­æåˆ°çš„all-reduceæŒ‡çš„æ˜¯ä¸€ç§å¹¶è¡Œè®¡ç®—ä¸­å¸¸ç”¨çš„é€šä¿¡æ“ä½œï¼Œå®ƒåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´è¿›è¡Œå…¨å±€å½’çº¦æ“ä½œã€‚åœ¨æ·±åº¦å­¦ä¹ è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œall-reduceæ“ä½œé€šå¸¸ç”¨äºåœ¨å¤šä¸ªGPUæˆ–è®¡ç®—èŠ‚ç‚¹ä¹‹é—´åŒæ­¥å‚æ•°æ›´æ–°ï¼Œä»¥ä¾¿åœ¨è®­ç»ƒå¤§å‹æ¨¡å‹æ—¶ç¡®ä¿å„ä¸ªèŠ‚ç‚¹çš„æ¨¡å‹å‚æ•°ä¿æŒä¸€è‡´ã€‚è¿™ç§æ“ä½œæ¶‰åŠåœ¨æ‰€æœ‰å‚ä¸èŠ‚ç‚¹ä¹‹é—´ä¼ è¾“å’Œèšåˆæ•°æ®ï¼Œå› æ­¤åœ¨æ¶‰åŠå¤§é‡GPUçš„æƒ…å†µä¸‹å¯èƒ½å˜å¾—éå¸¸è€—è´¹èµ„æºå’Œæ—¶é—´ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>å¦‚æœä»–ä»¬åœ¨äº‘ä¸­çš„æˆæœ¬çº¦ä¸ºæ¯å°æ—¶1ç¾å…ƒçš„A100ï¼Œé‚£ä¹ˆä»…æ­¤æ¬¡è¿è¡Œçš„è®­ç»ƒæˆæœ¬å°±çº¦ä¸º6300ä¸‡ç¾å…ƒã€‚è¿™è¿˜ä¸åŒ…æ‹¬æ‰€æœ‰çš„å®éªŒã€å¤±è´¥çš„è®­ç»ƒè¿è¡Œä»¥åŠå…¶ä»–æˆæœ¬ï¼Œå¦‚æ•°æ®æ”¶é›†ã€RLHFã€å‘˜å·¥ç­‰ã€‚ç”±äºè¿™äº›å› ç´ ï¼ŒçœŸæ­£çš„æˆæœ¬è¦é«˜å¾—å¤šã€‚æ­¤å¤–ï¼Œè¿™æ„å‘³ç€æ‚¨éœ€è¦æœ‰äººè´­ä¹°èŠ¯ç‰‡/ç½‘ç»œ/æ•°æ®ä¸­å¿ƒï¼Œæ‰¿æ‹…èµ„æœ¬æ”¯å‡ºï¼Œå¹¶å°†å…¶ç§Ÿç»™æ‚¨ã€‚&lt;/p>
&lt;p>å¦‚ä»Šï¼Œé¢„è®­ç»ƒå¯ä»¥åœ¨çº¦8,192ä¸ªH100ä¸Šè¿›è¡Œçº¦55å¤©ï¼Œæ¯å°æ—¶2ç¾å…ƒçš„H100æˆæœ¬ä¸º2150ä¸‡ç¾å…ƒã€‚æˆ‘ä»¬ç›¸ä¿¡åˆ°ä»Šå¹´åº•å°†æœ‰9å®¶å…¬å¸æ‹¥æœ‰æ›´å¤šçš„H100&lt;sup>3&lt;/sup>ã€‚å¹¶éæ‰€æœ‰è¿™äº›å…¬å¸éƒ½ä¼šå°†æ‰€æœ‰è®¾å¤‡ç”¨äºå•æ¬¡è®­ç»ƒè¿è¡Œï¼Œä½†é‚£äº›è¿™æ ·åšçš„å…¬å¸å°†æ‹¥æœ‰æ›´å¤§çš„æ¨¡å‹ã€‚Metaåˆ°ä»Šå¹´åº•å°†æ‹¥æœ‰è¶…è¿‡100,000ä¸ªH100ï¼Œä½†ç›¸å½“æ•°é‡çš„H100å°†åˆ†å¸ƒåœ¨ä»–ä»¬çš„æ•°æ®ä¸­å¿ƒè¿›è¡Œæ¨ç†ã€‚ä»–ä»¬æœ€å¤§çš„å•ä¸ªé›†ç¾¤ä»å°†è¿œè¶…25kä¸ªH100ã€‚&lt;/p>
&lt;p>åˆ°ä»Šå¹´åº•ï¼Œè®¸å¤šå…¬å¸å°†æ‹¥æœ‰è¶³å¤Ÿçš„è®¡ç®—èµ„æºæ¥è®­ç»ƒä¸€ä¸ªGPT-4å¤§å°çš„æ¨¡å‹ã€‚&lt;/p>
&lt;h2 id="æƒè¡¡-ä¹‹-æ··åˆä¸“å®¶æ¨¡å‹--mixture-of-expert-tradeoffs">æƒè¡¡ ä¹‹ æ··åˆä¸“å®¶æ¨¡å‹ Mixture of Expert Tradeoffs&lt;/h2>
&lt;p>MoEæ˜¯åœ¨æ¨ç†è¿‡ç¨‹ä¸­å‡å°‘å‚æ•°æ•°é‡çš„ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ï¼ŒåŒæ—¶ä»ç„¶å¯ä»¥å¢åŠ å‚æ•°æ•°é‡ï¼Œè¿™æ˜¯åœ¨æ¯ä¸ªè®­ç»ƒtokenä¸­ç¼–ç æ›´å¤šä¿¡æ¯æ‰€å¿…éœ€çš„ã€‚è¿™æ˜¯éå¸¸å¿…è¦çš„ï¼Œå› ä¸ºè·å–è¶³å¤Ÿå¤šçš„é«˜è´¨é‡tokenéå¸¸å›°éš¾ã€‚å¦‚æœOpenAIçœŸçš„è¦å°è¯•è¾¾åˆ°Chinchillaæœ€ä¼˜ï¼Œä»–ä»¬æœ¬æ¥éœ€è¦åœ¨2å€çš„tokenä¸Šè¿›è¡Œè®­ç»ƒã€‚&lt;/p>
&lt;p>è¯è™½å¦‚æ­¤ï¼ŒOpenAIåšå‡ºäº†å¤šç§æƒè¡¡ã€‚ä¾‹å¦‚ï¼ŒMoEåœ¨æ¨ç†è¿‡ç¨‹ä¸­éå¸¸éš¾ä»¥å¤„ç†ï¼Œå› ä¸ºåœ¨æ¯ä¸ªtokenç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œå¹¶éæ¨¡å‹çš„æ¯ä¸ªéƒ¨åˆ†éƒ½ä¼šè¢«åˆ©ç”¨ã€‚è¿™æ„å‘³ç€å½“å…¶ä»–éƒ¨åˆ†è¢«ä½¿ç”¨æ—¶ï¼ŒæŸäº›éƒ¨åˆ†å¯èƒ½å¤„äºä¼‘çœ çŠ¶æ€ã€‚åœ¨ä¸ºç”¨æˆ·æä¾›æœåŠ¡æ—¶ï¼Œè¿™ä¼šä¸¥é‡å½±å“åˆ©ç”¨ç‡ã€‚&lt;/p>
&lt;p>ç ”ç©¶äººå‘˜å·²ç»è¯æ˜ï¼Œä½¿ç”¨64åˆ°128ä¸ªä¸“å®¶æ¯”ä½¿ç”¨16ä¸ªä¸“å®¶èƒ½è·å¾—æ›´ä½çš„æŸå¤±ï¼Œä½†è¿™ä»…ä»…æ˜¯ç ”ç©¶ã€‚é€‰æ‹©è¾ƒå°‘ä¸“å®¶çš„åŸå› æœ‰å¾ˆå¤šã€‚OpenAIé€‰æ‹©16ä¸ªä¸“å®¶çš„ä¸€ä¸ªåŸå› æ˜¯ï¼Œæ›´å¤šçš„ä¸“å®¶å¾ˆéš¾åœ¨è®¸å¤šä»»åŠ¡ä¸­æ³›åŒ–ã€‚æ›´å¤šçš„ä¸“å®¶ä¹Ÿå¯èƒ½æ›´éš¾ä»¥å®ç°æ”¶æ•›ã€‚åœ¨å¦‚æ­¤å¤§è§„æ¨¡çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒOpenAIé€‰æ‹©åœ¨ä¸“å®¶æ•°é‡ä¸Šæ›´ä¸ºä¿å®ˆã€‚&lt;/p>
&lt;p>æ­¤å¤–ï¼Œä½¿ç”¨è¾ƒå°‘çš„ä¸“å®¶è¿˜æœ‰åŠ©äºé™ä½ä»–ä»¬çš„æ¨ç†åŸºç¡€è®¾æ–½çš„éœ€æ±‚ã€‚åœ¨è½¬å‘ä¸“å®¶æ··åˆæ¨ç†æ¶æ„æ—¶ï¼Œå­˜åœ¨å„ç§å›°éš¾çš„æƒè¡¡ã€‚åœ¨è®¨è®ºOpenAIé¢ä¸´çš„é—®é¢˜ä»¥åŠä»–ä»¬åšå‡ºçš„é€‰æ‹©ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆä»LLMsçš„æ¨ç†åŸºæœ¬æƒè¡¡å¼€å§‹ã€‚&lt;/p>
&lt;h2 id="æƒè¡¡-ä¹‹-æ¨ç†--inference-tradeoffs">æƒè¡¡ ä¹‹ æ¨ç† Inference Tradeoffs&lt;/h2>
&lt;p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬æƒ³é¡ºä¾¿æŒ‡å‡ºï¼Œæˆ‘ä»¬ä¸ä¹‹äº¤è°ˆè¿‡çš„æ¯ä¸€å®¶LLMå…¬å¸éƒ½è®¤ä¸ºNvidiaçš„FasterTransformeræ¨ç†åº“ç›¸å½“ç³Ÿç³•ï¼Œè€ŒTensorRTæ›´æ˜¯ç³Ÿç³•é€é¡¶ã€‚æ— æ³•å¯¹Nvidiaçš„æ¨¡æ¿è¿›è¡Œä¿®æ”¹æ„å‘³ç€äººä»¬éœ€è¦ä»å¤´å¼€å§‹åˆ›å»ºè‡ªå·±çš„è§£å†³æ–¹æ¡ˆã€‚å¯¹äºæ­£åœ¨é˜…è¯»æœ¬æ–‡çš„Nvidiaçš„äººå‘˜æ¥è¯´ï¼Œä½ ä»¬éœ€è¦å°½å¿«è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä»¥ä¾¿åœ¨LLMæ¨ç†æ–¹é¢å–å¾—ä¼˜åŠ¿ï¼Œå¦åˆ™å®é™…ä¸Šå°†æˆä¸ºä¸€ä¸ªå¼€æ”¾çš„å·¥å…·ï¼Œè¿™æ ·å¯ä»¥æ›´å®¹æ˜“åœ°æ·»åŠ ç¬¬ä¸‰æ–¹ç¡¬ä»¶æ”¯æŒã€‚ä¸€æ³¢å·¨å‹æ¨¡å‹å³å°†æ¥ä¸´ã€‚å¦‚æœåœ¨æ¨ç†æ–¹é¢æ²¡æœ‰è½¯ä»¶ä¼˜åŠ¿ï¼Œè€Œä¸”è¿˜éœ€è¦æ‰‹å†™å†…æ ¸ï¼Œé‚£ä¹ˆAMDçš„MI300&lt;sup>4&lt;/sup>å’Œå…¶ä»–ç¡¬ä»¶çš„å¸‚åœºå°†ä¼šæ›´å¤§ã€‚&lt;/p>
&lt;p>åœ¨æ‰¹é‡å¤§å°ï¼ˆåŒæ—¶æœåŠ¡çš„ç”¨æˆ·æ•°é‡ï¼‰ç»´åº¦å’Œæ‰€ä½¿ç”¨èŠ¯ç‰‡æ•°é‡æ–¹é¢ï¼Œå¤§å‹è¯­è¨€æ¨¡å‹æ¨ç†å­˜åœ¨3ä¸ªä¸»è¦æƒè¡¡ã€‚&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>å»¶è¿Ÿ&lt;/strong> - æ¨¡å‹å¿…é¡»åœ¨åˆç†çš„å»¶è¿Ÿå†…åšå‡ºå“åº”ã€‚äººä»¬åœ¨èŠå¤©åº”ç”¨ä¸­ç­‰å¾…è¾“å‡ºå¼€å§‹æµå¼ä¼ è¾“ä¹‹å‰ï¼Œä¸å¸Œæœ›ç­‰å¾…å¤ªé•¿æ—¶é—´ã€‚é¢„å¡«å……ï¼ˆè¾“å…¥ tokens ï¼‰å’Œè§£ç ï¼ˆè¾“å‡º tokens ï¼‰éœ€è¦ä¸åŒçš„æ—¶é—´æ¥å¤„ç†ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ååé‡&lt;/strong> - æ¨¡å‹å¿…é¡»æ¯ç§’è¾“å‡ºä¸€å®šæ•°é‡çš„ tokens ã€‚å¤§çº¦æ¯ç§’30ä¸ª tokens æ˜¯äººç±»æ‰€éœ€çš„ã€‚å¯¹äºå„ç§å…¶ä»–ç”¨ä¾‹ï¼Œè¾ƒä½å’Œè¾ƒé«˜çš„ååé‡ä¹Ÿå¯ä»¥æ¥å—ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>åˆ©ç”¨ç‡&lt;/strong> - è¿è¡Œæ¨¡å‹çš„ç¡¬ä»¶å¿…é¡»å®ç°é«˜åˆ©ç”¨ç‡ï¼Œå¦åˆ™æˆæœ¬ä¼šå¤ªé«˜ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ä½¿ç”¨æ›´é«˜çš„å»¶è¿Ÿå’Œæ›´ä½çš„ååé‡å°†æ›´å¤šçš„ç”¨æˆ·è¯·æ±‚ç»„åˆåœ¨ä¸€èµ·ï¼Œä»è€Œå®ç°æ›´é«˜çš„åˆ©ç”¨ç‡ï¼Œä½†è¿™ä¼šå¢åŠ éš¾åº¦&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>LLMæ¨ç†ä¸»è¦æ˜¯å…³äºå¹³è¡¡ä¸¤ä¸ªä¸»è¦æ–¹é¢ï¼šå†…å­˜å¸¦å®½å’Œè®¡ç®—èƒ½åŠ›ã€‚ç”¨æœ€ç®€åŒ–çš„æœ¯è¯­æ¥è¯´ï¼Œæ¯ä¸ªå‚æ•°éƒ½éœ€è¦è¢«è¯»å–ï¼Œå¹¶ä¸”ä¸ä¹‹ç›¸å…³çš„æœ‰2ä¸ªFLOPsã€‚å› æ­¤ï¼Œå¤§å¤šæ•°èŠ¯ç‰‡çš„æ¯”ä¾‹ï¼ˆH100 SXMåªæœ‰3TB/sçš„å†…å­˜å¸¦å®½ï¼Œä½†æœ‰2000 TFLOP/sçš„FP8è®¡ç®—èƒ½åŠ›ï¼‰å¯¹äºæ‰¹é‡å¤§å°ä¸º1çš„æ¨ç†æ¥è¯´æ˜¯å®Œå…¨ä¸å¹³è¡¡çš„ã€‚å¦‚æœåªæœ‰ä¸€ä¸ªç”¨æˆ·åœ¨ä½¿ç”¨ï¼Œæ‰¹é‡å¤§å°ä¸º1ï¼Œé‚£ä¹ˆå°†æ¯ä¸ªå‚æ•°æµå¼ä¼ è¾“åˆ°æ¯ä¸ª token ç”Ÿæˆæ‰€éœ€çš„å†…å­˜å¸¦å®½å°†ä¸»å¯¼æ¨ç†æ—¶é—´ã€‚è®¡ç®—æ—¶é—´å‡ ä¹ä¸ºé›¶ã€‚&lt;/p>
&lt;p>è¦å°†å¤§å‹è¯­è¨€æ¨¡å‹æœ‰æ•ˆåœ°æ‰©å±•åˆ°è®¸å¤šç”¨æˆ·ï¼Œæ‰¹é‡å¤§å°å¿…é¡»å¤§äº1ã€‚å¤šä¸ªç”¨æˆ·åˆ†æ‘Šå‚æ•°è¯»å–æˆæœ¬ã€‚ä¾‹å¦‚ï¼Œåœ¨æ‰¹é‡å¤§å°ä¸º256æˆ–512çš„æƒ…å†µä¸‹ï¼Œæ¯è¯»å…¥ä¸€ä¸ªå­—èŠ‚çš„å†…å­˜ï¼Œå°±æœ‰512 FLOP/sæˆ–1024 FLOP/sã€‚è¿™ä¸ªæ¯”ä¾‹æ›´æ¥è¿‘H100çš„å†…å­˜å¸¦å®½ä¸FLOPSä¹‹é—´çš„å…³ç³»ã€‚è¿™æœ‰åŠ©äºå®ç°æ›´é«˜çš„åˆ©ç”¨ç‡ï¼Œä½†åŒæ—¶ä¹Ÿå¸¦æ¥äº†æ›´é«˜çš„å»¶è¿Ÿã€‚&lt;/p>
&lt;p>è®¸å¤šäººè®¤ä¸ºå†…å­˜å®¹é‡æ˜¯LLMæ¨ç†çš„ä¸»è¦ç“¶é¢ˆï¼Œå› ä¸ºæ¨¡å‹çš„å¤§å°å¯ä»¥é€‚åº”å¤šä¸ªèŠ¯ç‰‡ï¼Œä½†è¿™æ˜¯é”™è¯¯çš„ã€‚è™½ç„¶å¤§å‹æ¨¡å‹éœ€è¦å¤šä¸ªèŠ¯ç‰‡è¿›è¡Œæ¨ç†ï¼Œè¾ƒé«˜çš„å†…å­˜å®¹é‡å¯¼è‡´å®ƒä»¬é€‚åº”æ›´å°‘çš„èŠ¯ç‰‡ï¼Œä½†å®é™…ä¸Šï¼Œæœ€å¥½ä½¿ç”¨æ¯”æ‰€éœ€å®¹é‡æ›´å¤šçš„èŠ¯ç‰‡ï¼Œä»¥ä¾¿é™ä½å»¶è¿Ÿï¼Œæé«˜ååé‡ï¼Œå¹¶ä½¿ç”¨æ›´å¤§çš„æ‰¹é‡å¤§å°ä»¥å®ç°æ›´é«˜çš„åˆ©ç”¨ç‡ã€‚&lt;/p>
&lt;p>è°·æ­Œåœ¨ä»–ä»¬çš„PaLMæ¨ç†è®ºæ–‡ä¸­å±•ç¤ºäº†è¿™äº›æƒè¡¡ã€‚ç„¶è€Œï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™æ˜¯é’ˆå¯¹åƒPaLMè¿™æ ·çš„å¯†é›†æ¨¡å‹ï¼Œè€Œä¸æ˜¯åƒGPT-4è¿™æ ·çš„ç¨€ç–æ¨¡å‹ã€‚&lt;/p>
&lt;p>&lt;img src="../../../en/p/gpt4/3.webp"
width="1646"
height="1286"
srcset="../../../en/p/gpt4/3_hu38eed891812559c0cec555c75c6f192c_89250_480x0_resize_q60_h2_box_2.webp 480w, ../../../en/p/gpt4/3_hu38eed891812559c0cec555c75c6f192c_89250_1536x0_resize_q60_h2_box_2.webp 1536w"
loading="lazy"
class="gallery-image"
data-flex-grow="127"
data-flex-basis="307px"
>&lt;/p>
&lt;p>å¦‚æœä¸€ä¸ªåº”ç”¨ç¨‹åºè¦æ±‚å°½å¯èƒ½ä½çš„å»¶è¿Ÿï¼Œæˆ‘ä»¬éœ€è¦åº”ç”¨æ›´å¤šçš„èŠ¯ç‰‡å¹¶ä»¥å°½å¯èƒ½å¤šçš„æ–¹å¼å¯¹æ¨¡å‹è¿›è¡Œåˆ’åˆ†ã€‚è¾ƒä½çš„å»¶è¿Ÿé€šå¸¸å¯ä»¥é€šè¿‡è¾ƒå°çš„æ‰¹é‡å¤§å°æ¥å®ç°ï¼Œä½†è¾ƒå°çš„æ‰¹é‡å¤§å°ä¹Ÿä¼šå¯¼è‡´è¾ƒå·®çš„MFU(åˆ©ç”¨ç‡)ï¼Œä»è€Œå¯¼è‡´æ¯ä¸ª token çš„æ€»æˆæœ¬ï¼ˆä»¥èŠ¯ç‰‡ç§’æˆ–ç¾å…ƒè®¡ï¼‰æ›´é«˜&lt;/p>
&lt;p>å¦‚æœä¸€ä¸ªåº”ç”¨ç¨‹åºéœ€è¦ç¦»çº¿æ¨ç†å¹¶ä¸”å»¶è¿Ÿä¸æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œä¸»è¦ç›®æ ‡æ˜¯æœ€å¤§åŒ–æ¯ä¸ªèŠ¯ç‰‡çš„ååé‡ï¼ˆå³ï¼Œæœ€å°åŒ–æ¯ä¸ª token çš„æ€»æˆæœ¬ï¼‰ã€‚æé«˜æ‰¹é‡å¤§å°æ˜¯æœ€æœ‰æ•ˆçš„æ–¹æ³•ï¼Œå› ä¸ºè¾ƒå¤§çš„æ‰¹é‡é€šå¸¸ä¼šå¯¼è‡´æ›´å¥½çš„MFU(åˆ©ç”¨ç‡)ï¼Œä½†æ˜¯éšç€æ‰¹é‡å¤§å°çš„å¢åŠ ï¼ŒæŸäº›å¯¹äºå°æ‰¹é‡å¤§å°ä¸é«˜æ•ˆçš„åˆ’åˆ†ç­–ç•¥å˜å¾—é«˜æ•ˆã€‚&lt;/p>
&lt;blockquote>
&lt;p>MFUæŒ‡çš„æ˜¯Memory Functional Unitï¼ˆå†…å­˜åŠŸèƒ½å•å…ƒï¼‰ï¼Œå®ƒæ˜¯è®¡ç®—è®¾å¤‡ï¼ˆå¦‚GPUæˆ–ASICèŠ¯ç‰‡ï¼‰ä¸­è´Ÿè´£å¤„ç†æ•°æ®å­˜å‚¨å’Œè®¿é—®çš„éƒ¨åˆ†ã€‚MFUçš„åˆ©ç”¨ç‡æ˜¯æŒ‡è¿™äº›å†…å­˜åŠŸèƒ½å•å…ƒåœ¨å¤„ç†ä»»åŠ¡æ—¶çš„æ•ˆç‡ã€‚æé«˜MFUåˆ©ç”¨ç‡æ„å‘³ç€è®¡ç®—è®¾å¤‡èƒ½æ›´æœ‰æ•ˆåœ°å¤„ç†æ•°æ®ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>æ›´å¤šçš„èŠ¯ç‰‡å’Œæ›´é«˜çš„æ‰¹é‡å¤§å°æ˜¯æœ€ä¾¿å®œçš„ï¼Œå› ä¸ºå®ƒä»¬æé«˜äº†åˆ©ç”¨ç‡ï¼Œä½†è¿™ä¹Ÿå¼•å…¥äº†ç¬¬ä¸‰ä¸ªå˜é‡ï¼Œç½‘ç»œæ—¶é—´ã€‚å°†æ¨¡å‹åˆ†å‰²åˆ°ä¸åŒèŠ¯ç‰‡ä¸Šçš„æŸäº›æ–¹æ³•åœ¨å»¶è¿Ÿæ–¹é¢æ›´æœ‰æ•ˆï¼Œä½†ä¼šåœ¨åˆ©ç”¨ç‡æ–¹é¢äº§ç”Ÿæƒè¡¡ã€‚&lt;/p>
&lt;p>æƒé‡åŠ è½½éƒ¨åˆ†çš„å†…å­˜æ—¶é—´å’Œéæ³¨æ„åŠ›è®¡ç®—æ—¶é—´ä¸æ¨¡å‹å¤§å°æˆæ­£æ¯”ï¼Œä¸èŠ¯ç‰‡æ•°é‡æˆåæ¯”ã€‚ç„¶è€Œï¼Œå¯¹äºç»™å®šçš„åˆ’åˆ†å¸ƒå±€ï¼ŒèŠ¯ç‰‡é—´é€šä¿¡æ‰€éœ€çš„æ—¶é—´å‡å°‘å¾—è¾ƒæ…¢ï¼ˆæˆ–è€…æ ¹æœ¬ä¸å‡å°‘ï¼‰ï¼Œå› æ­¤éšç€èŠ¯ç‰‡æ•°é‡çš„å¢åŠ ï¼Œå®ƒå˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚&lt;/p>
&lt;p>è™½ç„¶æˆ‘ä»¬ä»Šå¤©åªä¼šç®€è¦è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼Œä½†åº”è¯¥æŒ‡å‡ºçš„æ˜¯ï¼Œéšç€æ‰¹é‡å¤§å°å’Œåºåˆ—é•¿åº¦çš„å¢åŠ ï¼ŒKVç¼“å­˜çš„å†…å­˜éœ€æ±‚å‘ˆçˆ†ç‚¸å¼å¢é•¿ã€‚&lt;/p>
&lt;p>å¦‚æœä¸€ä¸ªåº”ç”¨ç¨‹åºéœ€è¦ç”Ÿæˆå…·æœ‰é•¿æ³¨æ„åŠ›ä¸Šä¸‹æ–‡çš„æ–‡æœ¬ï¼Œå®ƒä¼šæ˜¾è‘—å¢åŠ æ¨ç†æ—¶é—´ã€‚å¯¹äºä¸€ä¸ªå…·æœ‰å¤šå¤´æ³¨æ„åŠ›çš„500B+æ¨¡å‹ï¼Œæ³¨æ„åŠ›KVç¼“å­˜å˜å¾—å¾ˆå¤§ï¼šå¯¹äºæ‰¹é‡å¤§å°ä¸º512ä¸”ä¸Šä¸‹æ–‡é•¿åº¦ä¸º2048çš„æƒ…å†µï¼ŒKVç¼“å­˜æ€»è®¡ä¸º3TBï¼Œè¿™æ˜¯æ¨¡å‹å‚æ•°å¤§å°çš„3å€ã€‚èŠ¯ç‰‡çš„è®¡ç®—æ ¸å¿ƒåœ¨æ­¤æœŸé—´åŸºæœ¬ä¸Šæ˜¯ç©ºé—²çš„ï¼Œå› ä¸ºå®ƒéœ€è¦ä»ç‰‡å¤–å†…å­˜åŠ è½½è¿™ä¸ªKVç¼“å­˜ã€‚&lt;/p>
&lt;p>è¾ƒé•¿çš„åºåˆ—é•¿åº¦å¯¹å†…å­˜å¸¦å®½å’Œå†…å­˜å®¹é‡çš„å½±å“å°¤ä¸ºæ¶åŠ£ã€‚OpenAIçš„16kåºåˆ—é•¿åº¦çš„GPT 3.5 Turboå’Œ32kåºåˆ—é•¿åº¦çš„GPT 4ç”±äºå†…å­˜é™åˆ¶æ— æ³•ä½¿ç”¨è¾ƒå¤§çš„æ‰¹é‡å¤§å°ï¼Œå› æ­¤ä»·æ ¼æ›´é«˜ã€‚è¾ƒä½çš„æ‰¹é‡å¤§å°å¯¼è‡´è¾ƒä½çš„ç¡¬ä»¶åˆ©ç”¨ç‡ã€‚æ­¤å¤–ï¼Œéšç€åºåˆ—é•¿åº¦çš„å¢åŠ ï¼ŒKVç¼“å­˜è†¨èƒ€ã€‚KVç¼“å­˜æ— æ³•åœ¨ç”¨æˆ·ä¹‹é—´å…±äº«ï¼Œå› æ­¤éœ€è¦å•ç‹¬è¯»å–å†…å­˜ï¼Œè¿›ä¸€æ­¥é™åˆ¶å†…å­˜å¸¦å®½ã€‚ç¨åä¼šæœ‰æ›´å¤šå…³äºMQAï¼ˆMulti-Query Attentionï¼‰çš„å†…å®¹ã€‚&lt;/p>
&lt;h2 id="gpt-4-inference-tradeoffs-and-infrastructure">GPT-4 Inference Tradeoffs And Infrastructure&lt;/h2>
&lt;p>ä»¥ä¸Šæ‰€è¯´åˆ°çš„å›°éš¾åœ¨ GPT-4 æ¨ç†ä¸­éƒ½ä¼šé‡åˆ°ï¼Œä½†æ˜¯ä¸“å®¶æ··åˆï¼ˆMoEï¼‰æ¨¡å‹æ¶æ„çš„å¼•å…¥ä¼šå¸¦æ¥æ–°çš„å›°éš¾ã€‚æ¯ä¸ª token ç”Ÿæˆçš„å‰å‘ä¼ æ’­å¯ä»¥è·¯ç”±åˆ°ä¸åŒçš„ä¸“å®¶é›†åˆã€‚è¿™åœ¨ååé‡ã€å»¶è¿Ÿå’Œæ›´é«˜æ‰¹é‡å¤§å°çš„åˆ©ç”¨ç‡ä¹‹é—´è¾¾åˆ°çš„æƒè¡¡ä¸­äº§ç”Ÿäº†é—®é¢˜ã€‚&lt;/p>
&lt;p>OpenAI çš„ GPT-4 æœ‰ 16 ä¸ªä¸“å®¶ï¼Œæ¯ä¸ªå‰å‘ä¼ æ’­æœ‰ 2 ä¸ªã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœæ‰¹é‡å¤§å°ä¸º 8ï¼Œæ¯ä¸ªä¸“å®¶çš„å‚æ•°è¯»å–å¯èƒ½ä»…ä¸ºæ‰¹é‡å¤§å° 1ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œè¿™å¯èƒ½æ„å‘³ç€ 1 ä¸ªä¸“å®¶çš„æ‰¹é‡å¤§å°å¯èƒ½ä¸º 8ï¼Œè€Œå…¶ä»–ä¸“å®¶çš„æ‰¹é‡å¤§å°å¯èƒ½ä¸º 4ã€1 æˆ– 0ã€‚æ¯ä¸€æ¬¡ token ç”Ÿæˆï¼Œè·¯ç”±ç®—æ³•éƒ½ä¼šå°†å‰å‘ä¼ æ’­å‘é€åˆ°ä¸åŒçš„æ–¹å‘ï¼Œå¯¼è‡´ token åˆ° token å»¶è¿Ÿä»¥åŠä¸“å®¶æ‰¹é‡å¤§å°çš„æ˜¾è‘—å˜åŒ–ã€‚&lt;/p>
&lt;p>æ¨ç†åŸºç¡€è®¾æ–½æ˜¯ OpenAI é€‰æ‹©æ›´å°‘ä¸“å®¶æ•°é‡çš„ä¸»è¦åŸå› ã€‚å¦‚æœä»–ä»¬é€‰æ‹©æ›´å¤šçš„ä¸“å®¶ï¼Œå†…å­˜å¸¦å®½å°†è¿›ä¸€æ­¥é™åˆ¶æ¨ç†ã€‚OpenAI åœ¨ä»–ä»¬çš„æ¨ç†é›†ç¾¤ä¸Šç»å¸¸è¾¾åˆ° 4k+ çš„æ‰¹é‡å¤§å°ï¼Œè¿™æ„å‘³ç€å³ä½¿åœ¨ä¸“å®¶ä¹‹é—´è¿›è¡Œæœ€ä½³è´Ÿè½½å¹³è¡¡ï¼Œä¸“å®¶ä»¬çš„æ‰¹é‡å¤§å°ä¹Ÿåªæœ‰çº¦ 500ã€‚å®ç°è¿™ä¸€ç‚¹éœ€è¦éå¸¸å¤§é‡çš„ä½¿ç”¨ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬äº†è§£åˆ°ï¼ŒOpenAI åœ¨ 128 ä¸ª GPU çš„é›†ç¾¤ä¸Šè¿è¡Œæ¨ç†ã€‚ä»–ä»¬åœ¨å¤šä¸ªæ•°æ®ä¸­å¿ƒå’Œåœ°ç†ä½ç½®æ‹¥æœ‰å¤šä¸ªè¿™æ ·çš„é›†ç¾¤ã€‚æ¨ç†æ˜¯åœ¨ 8 è·¯å¼ é‡å¹¶è¡Œå’Œ 16 è·¯æµæ°´çº¿å¹¶è¡Œä¸‹å®Œæˆçš„ã€‚æ¯ä¸ªåŒ…å« 8 ä¸ª GPU çš„èŠ‚ç‚¹åªæœ‰çº¦ 130B å‚æ•°ï¼Œå³æ¯ä¸ª GPU åœ¨ FP16 ä¸‹ä¸åˆ° 30GBï¼Œåœ¨ FP8/int8 ä¸‹ä¸åˆ° 15GBã€‚è¿™ä½¿å¾—æ¨ç†å¯ä»¥åœ¨ 40GB A100 ä¸Šè¿è¡Œï¼Œåªè¦ KV ç¼“å­˜å¤§å°åœ¨æ‰€æœ‰æ‰¹æ¬¡ä¸­ä¸ä¼šè¿‡å¤§ã€‚&lt;/p>
&lt;p>åŒ…å«å„ç§ä¸“å®¶çš„å•ç‹¬å±‚ä¸ä¼šåœ¨ä¸åŒèŠ‚ç‚¹ä¹‹é—´æ‹†åˆ†ï¼Œå› ä¸ºè¿™ä¼šä½¿ç½‘ç»œæµé‡è¿‡äºä¸è§„å¾‹ï¼Œè€Œåœ¨æ¯ä¸ª token ç”Ÿæˆä¹‹é—´é‡æ–°è®¡ç®— KV ç¼“å­˜çš„æˆæœ¬ä¼šéå¸¸é«˜ã€‚ä»»ä½•æœªæ¥ MoE æ¨¡å‹æ‰©å±•å’Œæ¡ä»¶è·¯ç”±çš„æœ€å¤§å›°éš¾æ˜¯å¦‚ä½•å¤„ç†ç»•è¿‡ KV ç¼“å­˜çš„è·¯ç”±ã€‚&lt;/p>
&lt;p>å±‚çš„æ•°é‡æ˜¯ 120ï¼Œæ‰€ä»¥åœ¨ 15 ä¸ªä¸åŒçš„èŠ‚ç‚¹ä¹‹é—´è¿›è¡Œåˆ’åˆ†æ˜¯ç®€å•çš„ï¼Œä½†æ˜¯å› ä¸ºç¬¬ä¸€ä¸ªèŠ‚ç‚¹éœ€è¦è¿›è¡Œæ•°æ®åŠ è½½å’ŒåµŒå…¥ï¼Œæ‰€ä»¥åœ¨æ¨ç†é›†ç¾¤çš„å¤´èŠ‚ç‚¹ä¸Šæ”¾ç½®è¾ƒå°‘çš„å±‚æ˜¯æœ‰æ„ä¹‰çš„ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€äº›å…³äºæŠ•æœºè§£ç çš„ä¼ è¨€ï¼Œæˆ‘ä»¬ç¨åä¼šè®¨è®ºï¼Œä½†æˆ‘ä»¬ä¸ç¡®å®šæ˜¯å¦ç›¸ä¿¡å®ƒä»¬ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆå¤´èŠ‚ç‚¹éœ€è¦åŒ…å«æ›´å°‘çš„å±‚ã€‚&lt;/p>
&lt;h2 id="gpt-4-æ¨ç†è´¹ç”¨-gpt-4-inference-cost">GPT-4 æ¨ç†è´¹ç”¨ GPT-4 Inference Cost&lt;/h2>
&lt;p>GPT-4çš„æˆæœ¬æ˜¯175Bå‚æ•°Davinchiæ¨¡å‹çš„3å€ï¼Œå°½ç®¡å…¶å‰é¦ˆå‚æ•°ä»…ä¸º1.6å€ã€‚è¿™ä¸»è¦æ˜¯ç”±äºGPT-4æ‰€éœ€çš„å¤§å‹é›†ç¾¤æ›´å¤šï¼Œä»¥åŠå®ç°çš„åˆ©ç”¨ç‡è¾ƒä½ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬è®¤ä¸ºï¼Œå¯¹äº128ä¸ªA100sè¿›è¡ŒGPT-4 8k seqlenæ¨ç†ï¼Œæ¯1k tokensçš„æˆæœ¬ä¸º0.0049ç¾åˆ†ï¼›è€Œå¯¹äº128ä¸ªH100sè¿›è¡ŒGPT-4 8k seqlenæ¨ç†ï¼Œæ¯1k tokensçš„æˆæœ¬ä¸º0.0021ç¾åˆ†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å‡è®¾è¾ƒé«˜çš„åˆ©ç”¨ç‡ï¼Œå¹¶ä¿æŒæ‰¹é‡å¤§å°è¾ƒé«˜ã€‚&lt;/p>
&lt;p>è¿™å¯èƒ½æ˜¯ä¸€ä¸ªé”™è¯¯çš„å‡è®¾ï¼Œå› ä¸ºå¾ˆæ˜æ˜¾OpenAIæœ‰æ—¶åˆ©ç”¨ç‡éå¸¸ä½ã€‚æˆ‘ä»¬è®¤ä¸ºOpenAIåœ¨ä½è°·æ—¶æ®µå…³é—­é›†ç¾¤ï¼Œå¹¶å°†è¿™äº›èŠ‚ç‚¹é‡æ–°ç”¨äºä»æ£€æŸ¥ç‚¹æ¢å¤è®­ç»ƒè¾ƒå°çš„æµ‹è¯•æ¨¡å‹ï¼Œå°è¯•å„ç§æ–°æŠ€æœ¯ã€‚è¿™æœ‰åŠ©äºé™ä½æ¨ç†æˆæœ¬ã€‚å¦‚æœOpenAIä¸è¿™æ ·åšï¼Œä»–ä»¬çš„åˆ©ç”¨ç‡ä¼šæ›´ä½ï¼Œæˆ‘ä»¬çš„æˆæœ¬ä¼°è®¡ä¼šç¿»ä¸€ç•ªä»¥ä¸Šã€‚&lt;/p>
&lt;h2 id="multi-query-attention">Multi-Query Attention&lt;/h2>
&lt;p>MQAï¼ˆMulti-Query Attentionï¼Œå¤šæŸ¥è¯¢æ³¨æ„åŠ›ï¼‰æ˜¯å…¶ä»–æ‰€æœ‰äººéƒ½åœ¨åšçš„äº‹æƒ…ï¼Œä½†æˆ‘ä»¬æƒ³æŒ‡å‡ºOpenAIä¹Ÿåœ¨åšã€‚é•¿è¯çŸ­è¯´ï¼Œåªéœ€è¦1ä¸ªå¤´ï¼ŒKVç¼“å­˜çš„å†…å­˜å®¹é‡å¯ä»¥æ˜¾è‘—å‡å°‘ã€‚å³ä¾¿å¦‚æ­¤ï¼Œ32k seqlençš„GPT-4è‚¯å®šæ— æ³•åœ¨40GBçš„A100sä¸Šè¿è¡Œï¼Œè€Œ8kçš„æœ€å¤§æ‰¹é‡å¤§å°å—åˆ°é™åˆ¶ã€‚å¦‚æœæ²¡æœ‰å®ƒï¼Œ8kçš„æœ€å¤§æ‰¹é‡å¤§å°å°†å—åˆ°å¾ˆå¤§é™åˆ¶ï¼Œä»¥è‡³äºå˜å¾—ä¸ç»æµã€‚&lt;/p>
&lt;h2 id="è¿ç»­æ‰¹é‡å¤„ç†-continuous-batching">è¿ç»­æ‰¹é‡å¤„ç† Continuous batching&lt;/h2>
&lt;p>OpenAI å®ç°äº†å¯å˜æ‰¹é‡å¤§å°å’Œè¿ç»­æ‰¹é‡å¤„ç†ã€‚ è¿™æ˜¯ä¸ºäº†å…è®¸ä¸€å®šç¨‹åº¦çš„æå¤§åœ°ä¼˜åŒ–äº†å»¶è¿Ÿå¹¶ä¼˜åŒ–æ¨ç†æˆæœ¬ã€‚ å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰è¿™ä¸ªæ¦‚å¿µï¼ŒAnyScale ä¸Šé¢çš„è¿™ç¯‡æ–‡ç« &lt;sup>5&lt;/sup>å€¼å¾—ä¸€è¯»ã€‚&lt;/p>
&lt;p>&lt;img src="../../../en/p/gpt4/4.webp"
width="2792"
height="1026"
srcset="../../../en/p/gpt4/4_hu1c9d7d0d95598f5f214ad59bf94f1f72_242664_480x0_resize_q60_h2_box_2.webp 480w, ../../../en/p/gpt4/4_hu1c9d7d0d95598f5f214ad59bf94f1f72_242664_1536x0_resize_q60_h2_box_2.webp 1536w"
loading="lazy"
class="gallery-image"
data-flex-grow="272"
data-flex-basis="653px"
>
&lt;img src="../../../en/p/gpt4/5.webp"
width="2786"
height="944"
srcset="../../../en/p/gpt4/5_hu7fb229a62bfe6d060237c57576f0dbe7_246560_480x0_resize_q60_h2_box_2.webp 480w, ../../../en/p/gpt4/5_hu7fb229a62bfe6d060237c57576f0dbe7_246560_1536x0_resize_q60_h2_box_2.webp 1536w"
loading="lazy"
class="gallery-image"
data-flex-grow="295"
data-flex-basis="708px"
>&lt;/p>
&lt;h2 id="æ¨æµ‹æ€§è§£ç -speculative-decoding">æ¨æµ‹æ€§è§£ç  Speculative Decoding&lt;/h2>
&lt;p>æˆ‘ä»¬ä»ä¸€äº›å¯é çš„äººé‚£é‡Œå¬è¯´ï¼ŒOpenAIåœ¨GPT-4æ¨ç†ä¸­ä½¿ç”¨äº†æ¨æµ‹æ€§è§£ç ã€‚æˆ‘ä»¬ä¸ç¡®å®šæ˜¯å¦ç›¸ä¿¡è¿™ä¸€ç‚¹ã€‚åœ¨è¿›è¡Œç®€å•æ£€ç´¢ä»»åŠ¡å’Œæ›´å¤æ‚ä»»åŠ¡æ—¶ï¼Œtoken to token å»¶è¿Ÿåœ¨ä¸åŒæ—¶é—´æ®µä¸‹ä¼šäº§ç”Ÿå˜åŒ–å’Œå·®å¼‚&lt;sup>6&lt;/sup>ä¼¼ä¹è¡¨æ˜è¿™æ˜¯å¯èƒ½çš„ï¼Œä½†æœ‰å¤ªå¤šçš„å˜é‡æ— æ³•çŸ¥é“ã€‚ä»¥é˜²ä¸‡ä¸€ï¼Œæˆ‘ä»¬å°†åœ¨è¿™é‡Œé€šè¿‡ä½¿ç”¨â€œåŠ é€ŸLLMæ¨ç†ä¸åˆ†é˜¶æ®µæ¨æµ‹æ€§è§£ç â€çš„ä¸€äº›æ–‡æœ¬å¹¶è¿›è¡Œä¸€äº›ä¿®æ”¹/æ·»åŠ ä¸€äº›å†…å®¹æ¥è§£é‡Šå®ƒã€‚&lt;/p>
&lt;p>é€šå¸¸å°†ä½¿ç”¨LLMåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µã€‚é¦–å…ˆæ˜¯é¢„å¡«å……ï¼Œå°†æç¤ºé€šè¿‡æ¨¡å‹ç”ŸæˆKVç¼“å­˜å’Œç¬¬ä¸€ä¸ªè¾“å‡ºæ¦‚ç‡åˆ†å¸ƒï¼ˆå¯èƒ½çš„ token è¾“å‡ºï¼‰ã€‚è¿™é€šå¸¸å¾ˆå¿«ï¼Œå› ä¸ºæ•´ä¸ªæç¤ºå¯ä»¥å¹¶è¡Œå¤„ç†ã€‚&lt;/p>
&lt;p>ç¬¬äºŒé˜¶æ®µæ˜¯è§£ç ã€‚ä»è¾“å‡ºçš„æ¦‚ç‡åˆ†å¸ƒä¸­é€‰æ‹©ä¸€ä¸ª token å¹¶å°†å…¶åé¦ˆåˆ°æ¨¡å‹ä¸­ï¼Œè¯¥æ¨¡å‹ä¸ºåç»­ token ç”Ÿæˆæ¦‚ç‡åˆ†å¸ƒã€‚è¿™ä¸€è¿‡ç¨‹é‡å¤è¿›è¡Œï¼Œç›´åˆ°ç”Ÿæˆæ‰€éœ€æ•°é‡çš„ token ã€‚ç”±äºè§£ç å¿…é¡»æŒ‰é¡ºåºé€šè¿‡è®¡ç®—å•å…ƒæµå¼ä¼ è¾“æƒé‡ä»¥ç”Ÿæˆå•ä¸ª token ï¼Œå› æ­¤è¿™ç¬¬äºŒé˜¶æ®µçš„ç®—æœ¯å¼ºåº¦ï¼ˆarithmetic intensityï¼Œè®¡ç®—FLOP /å†…å­˜å¸¦å®½å­—èŠ‚ï¼‰åœ¨å°æ‰¹é‡è¿è¡Œæ—¶æä½ã€‚å› æ­¤ï¼Œè§£ç é€šå¸¸æ˜¯è‡ªå›å½’ç”Ÿæˆä¸­æœ€æ˜‚è´µçš„éƒ¨åˆ†ã€‚&lt;/p>
&lt;p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨OpenAIçš„APIè°ƒç”¨ä¸­ï¼Œè¾“å…¥ token æ¯”è¾“å‡º token ä¾¿å®œå¾—å¤šã€‚æ¨æµ‹æ€§è§£ç çš„åŸºæœ¬æ€æƒ³æ˜¯ä½¿ç”¨ä¸€ä¸ªæ›´å°ã€æ›´å¿«çš„è‰ç¨¿æ¨¡å‹æå‰è§£ç å‡ ä¸ª token ï¼Œç„¶åå°†å®ƒä»¬ä½œä¸ºå•ä¸ªæ‰¹æ¬¡è¾“å…¥åˆ°oracleæ¨¡å‹ä¸­ã€‚å¦‚æœè‰ç¨¿æ¨¡å‹å¯¹å…¶é¢„æµ‹æ˜¯æ­£ç¡®çš„â€”â€”æ›´å¤§çš„æ¨¡å‹åŒæ„â€”â€”å¯ä»¥ç”¨å•ä¸ªæ‰¹æ¬¡è§£ç å‡ ä¸ª token ï¼Œä»è€ŒèŠ‚çœå¤§é‡çš„å†…å­˜å¸¦å®½ï¼Œå› æ­¤æ¯ä¸ª token çš„æ—¶é—´ä¹ŸèŠ‚çœäº†ã€‚&lt;/p>
&lt;p>ç„¶è€Œï¼Œå¦‚æœè¾ƒå¤§çš„æ¨¡å‹æ‹’ç»äº†è‰ç¨¿æ¨¡å‹é¢„æµ‹çš„ token ï¼Œé‚£ä¹ˆå°†ä¸¢å¼ƒæ‰¹æ¬¡çš„å…¶ä½™éƒ¨åˆ†ï¼Œå¹¶ä¸”ç®—æ³•è‡ªç„¶åœ°æ¢å¤åˆ°æ ‡å‡†çš„é€ token è§£ç ã€‚æ¨æµ‹æ€§è§£ç è¿˜å¯ä»¥ä¼´éšç€æ‹’ç»æŠ½æ ·æ–¹æ¡ˆï¼Œä»åŸå§‹åˆ†å¸ƒä¸­æŠ½æ ·ã€‚è¯·æ³¨æ„ï¼Œè¿™ä»…åœ¨å¸¦å®½æ˜¯ç“¶é¢ˆçš„å°æ‰¹é‡è®¾ç½®ä¸­æœ‰ç”¨ã€‚&lt;/p>
&lt;p>æ¨æµ‹æ€§è§£ç ç”¨è®¡ç®—æ¢å¸¦å®½ã€‚æ¨æµ‹æ€§è§£ç æ˜¯ä¸€ä¸ªæœ‰å¸å¼•åŠ›çš„æ€§èƒ½å·¥ç¨‹ç›®æ ‡çš„ä¸¤ä¸ªå…³é”®åŸå› æ˜¯ï¼šé¦–å…ˆï¼Œå®ƒæ ¹æœ¬ä¸ä¼šé™ä½æ¨¡å‹è´¨é‡ã€‚å…¶æ¬¡ï¼Œå®ƒæä¾›çš„æ”¶ç›Šé€šå¸¸ä¸å…¶ä»–æ–¹æ³•æ­£äº¤ï¼Œå› ä¸ºå…¶æ€§èƒ½æ¥è‡ªå°†é¡ºåºæ‰§è¡Œè½¬æ¢ä¸ºå¹¶è¡Œæ‰§è¡Œã€‚&lt;/p>
&lt;p>å½“å‰çš„æ¨æµ‹æ–¹æ³•ä¸ºæ‰¹æ¬¡é¢„æµ‹å•ä¸ªåºåˆ—ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•ä¸èƒ½å¾ˆå¥½åœ°æ‰©å±•åˆ°å¤§æ‰¹é‡å¤§å°æˆ–ä½è‰ç¨¿æ¨¡å‹å¯¹é½ã€‚ç›´è§‚åœ°è¯´ï¼Œä¸¤ä¸ªæ¨¡å‹å¯¹äºé•¿è¿ç»­ token åºåˆ—è¾¾æˆä¸€è‡´çš„æ¦‚ç‡å‘ˆæŒ‡æ•°çº§ä¸‹é™ï¼Œè¿™æ„å‘³ç€éšç€ç®—æœ¯å¼ºåº¦çš„å¢åŠ ï¼Œæ¨æµ‹æ€§è§£ç çš„æ”¶ç›Šè¿…é€Ÿå‡å°ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬è®¤ä¸ºï¼Œå¦‚æœOpenAIä½¿ç”¨æ¨æµ‹æ€§è§£ç ï¼Œä»–ä»¬å¯èƒ½åªä½¿ç”¨å®ƒæ¥å¤„ç†å¤§çº¦4ä¸ª token çš„åºåˆ—ã€‚å¦å¤–ï¼Œå…³äºé™ä½GPT-4è´¨é‡çš„æ•´ä¸ªé˜´è°‹å¯èƒ½ä»…ä»…æ˜¯å› ä¸ºä»–ä»¬è®©oracleæ¨¡å‹æ¥å—æ¥è‡ªæ¨æµ‹æ€§è§£ç æ¨¡å‹çš„è¾ƒä½æ¦‚ç‡åºåˆ—ã€‚å¦ä¸€ä¸ªæ’æ›²æ˜¯ï¼Œæœ‰äº›äººä»¬çŒœæµ‹bardä½¿ç”¨æ¨æµ‹æ€§è§£ç ï¼Œå› ä¸ºGoogleåœ¨å°†æ•´ä¸ªåºåˆ—å‘é€ç»™ç”¨æˆ·ä¹‹å‰ç­‰å¾…åºåˆ—ç”Ÿæˆï¼Œä½†æˆ‘ä»¬ä¸è®¤ä¸ºè¿™ç§çŒœæµ‹æ˜¯æ­£ç¡®çš„ã€‚&lt;/p>
&lt;p>æ€»ä¹‹ï¼Œæ¨æµ‹æ€§è§£ç æ˜¯ä¸€ç§åœ¨ä¸é™ä½æ¨¡å‹è´¨é‡çš„æƒ…å†µä¸‹æé«˜æ€§èƒ½çš„æ–¹æ³•ï¼Œå®ƒé€šè¿‡é™ä½å†…å­˜å¸¦å®½éœ€æ±‚æ¥å®ç°ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½ä¼šå—åˆ°é™åˆ¶ï¼Œä¾‹å¦‚å¤§æ‰¹é‡å¤§å°æˆ–ä½è‰ç¨¿æ¨¡å‹å¯¹é½ã€‚OpenAIå¯èƒ½åœ¨GPT-4ä¸­ä½¿ç”¨äº†æ¨æµ‹æ€§è§£ç ï¼Œä½†æˆ‘ä»¬ä¸èƒ½ç¡®å®šå®ƒä»¬æ˜¯å¦ç¡®å®é‡‡ç”¨äº†è¿™ç§æ–¹æ³•ã€‚æ­¤å¤–ï¼Œå…³äºGPT-4è´¨é‡é™ä½çš„é˜´è°‹è®ºå¯èƒ½ä¸æ¨æµ‹æ€§è§£ç æ¨¡å‹æ¥å—è¾ƒä½æ¦‚ç‡åºåˆ—æœ‰å…³ã€‚å°½ç®¡æœ‰å…³bardä½¿ç”¨æ¨æµ‹æ€§è§£ç çš„çŒœæµ‹å­˜åœ¨ï¼Œä½†æˆ‘ä»¬ä¸ç›¸ä¿¡è¿™ç§çŒœæµ‹æ˜¯æ­£ç¡®çš„ã€‚&lt;/p>
&lt;h2 id="è§†è§‰å¤šæ¨¡æ€-vision-multi-modal">è§†è§‰å¤šæ¨¡æ€ Vision Multi-Modal&lt;/h2>
&lt;p>GPT-4 çš„è§†è§‰å¤šæ¨¡æ€åŠŸèƒ½æ˜¯ç›¸å¯¹ä¸å¤ªä»¤äººå°è±¡æ·±åˆ»çš„éƒ¨åˆ†ï¼Œè‡³å°‘ä¸é¢†å…ˆçš„ç ”ç©¶ç›¸æ¯”ã€‚å½“ç„¶ï¼Œç›®å‰è¿˜æ²¡æœ‰äººå°†è¿™äº›ç ”ç©¶å•†ä¸šåŒ–ä¸ºå¤šæ¨¡æ€LLMã€‚&lt;/p>
&lt;p>è§†è§‰ç¼–ç å™¨ä¸æ–‡æœ¬ç¼–ç å™¨æ˜¯åˆ†å¼€çš„ï¼Œä½†å­˜åœ¨äº¤å‰æ³¨æ„åŠ›ã€‚æˆ‘ä»¬äº†è§£åˆ°ï¼Œå…¶æ¶æ„ç±»ä¼¼äºFlamingoã€‚è¿™åœ¨GPT-4çš„1.8Tå‚æ•°ä¹‹ä¸Šå¢åŠ äº†æ›´å¤šå‚æ•°ã€‚åœ¨ä»…æ–‡æœ¬é¢„è®­ç»ƒä¹‹åï¼Œå®ƒä¼šä½¿ç”¨å¦å¤–å¤§çº¦2ä¸‡äº¿ä¸ª token è¿›è¡Œå¾®è°ƒã€‚&lt;/p>
&lt;p>åœ¨è§†è§‰æ¨¡å‹æ–¹é¢ï¼ŒOpenAIå¸Œæœ›ä»å¤´å¼€å§‹è®­ç»ƒï¼Œä½†æˆç†Ÿåº¦ä¸å¤Ÿï¼Œå› æ­¤ä»–ä»¬å¸Œæœ›é€šè¿‡ä»æ–‡æœ¬å¼€å§‹æ¥é™ä½é£é™©ã€‚&lt;/p>
&lt;p>ä»–ä»¬å°†è®­ç»ƒçš„ä¸‹ä¸€ä¸ªæ¨¡å‹ï¼ŒGPT-5ï¼Œæ®ç§°å°†ä»å¤´å¼€å§‹è¿›è¡Œè§†è§‰è®­ç»ƒï¼Œå¹¶èƒ½å¤Ÿè‡ªå·±ç”Ÿæˆå›¾åƒã€‚æ­¤å¤–ï¼Œå®ƒè¿˜å°†èƒ½å¤Ÿå¤„ç†éŸ³é¢‘ã€‚&lt;/p>
&lt;p>è¿™ç§è§†è§‰åŠŸèƒ½çš„ä¸»è¦ç›®çš„ä¹‹ä¸€æ˜¯ç”¨äºèƒ½å¤Ÿé˜…è¯»ç½‘é¡µå¹¶è½¬å½•å›¾åƒå’Œè§†é¢‘å†…å®¹çš„è‡ªä¸»ä»£ç†ã€‚ä»–ä»¬è®­ç»ƒçš„ä¸€äº›æ•°æ®æ˜¯è”åˆæ•°æ®ï¼ˆæ¸²æŸ“çš„LaTeX/æ–‡æœ¬ï¼‰ã€ç½‘é¡µæˆªå›¾ã€YouTube è§†é¢‘ä¸­çš„éƒ¨åˆ†å¸§åŠè¿è¡Œ Whisper ä»¥è·å–è¯­éŸ³è½¬æ–‡æœ¬ã€‚&lt;/p>
&lt;p>å…³äºLLMè¿‡åº¦ä¼˜åŒ–çš„ä¸€ä¸ªæœ‰è¶£ä¹‹å¤„æ˜¯ï¼Œè§†è§‰æ¨¡å‹çš„IOæˆæœ¬ä¸æ–‡æœ¬æ¨¡å‹ä¸åŒã€‚åœ¨æ–‡æœ¬æ¨¡å‹ä¸­ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨ã€Šäºšé©¬é€Šäº‘å±æœºã€‹&lt;sup>7&lt;/sup>ä¸€æ–‡ä¸­æ‰€æè¿°çš„ï¼Œå®ƒéå¸¸ä¾¿å®œã€‚åœ¨è§†è§‰ä¸Šï¼Œæ•°æ®åŠ è½½çš„IOçº¦ä¸º150å€ã€‚æ¯ä¸ªå›¾åƒ token 600å­—èŠ‚ï¼Œè€Œæ–‡æœ¬åˆ™ä¸º4å­—èŠ‚ã€‚ç›®å‰æ­£åœ¨è¿›è¡Œå¤§é‡çš„å›¾åƒå‹ç¼©å·¥ä½œã€‚&lt;/p>
&lt;p>è¿™å¯¹äºé‚£äº›é’ˆå¯¹2-3å¹´åçš„LLMsä¼˜åŒ–ç¡¬ä»¶çš„ç¡¬ä»¶ä¾›åº”å•†éå¸¸ç›¸å…³ã€‚ä»–ä»¬å¯èƒ½ä¼šå‘ç°è‡ªå·±ç”Ÿæ´»åœ¨ä¸€ä¸ªæ¯ä¸ªæ¨¡å‹éƒ½å…·æœ‰å¼ºå¤§è§†è§‰å’ŒéŸ³é¢‘åŠŸèƒ½çš„ä¸–ç•Œé‡Œã€‚ä»–ä»¬å¯èƒ½ä¼šå‘ç°è‡ªå·±çš„æ¶æ„é€‚åº”æ€§è¾ƒå·®ã€‚æ€»çš„æ¥è¯´ï¼Œæ¶æ„è‚¯å®šä¼šè¶…è¶Šæˆ‘ä»¬ä»Šå¤©æ‰€çœ‹åˆ°çš„åŸºäºå½“å‰ç®€åŒ–æ–‡æœ¬çš„å¯†é›†å‹å’Œ/æˆ–MoEæ¨¡å‹ã€‚&lt;/p>
&lt;h2 id="å¼•ç”¨-reference">å¼•ç”¨ Reference&lt;/h2>
&lt;ul>
&lt;li>[1] &lt;a class="link" href="https://www.semianalysis.com/p/the-ai-brick-wall-a-practical-limit" target="_blank" rel="noopener"
>The AI Brick Wall â€“ A Practical Limit For Scaling Dense Transformer Models, and How GPT 4 Will Break Past It&lt;/a>&lt;/li>
&lt;li>[2] &lt;a class="link" href="https://www.semianalysis.com/p/on-device-ai-double-edged-sword" target="_blank" rel="noopener"
>On Device AI â€“ Double-Edged Sword&lt;/a>&lt;/li>
&lt;li>[3] &lt;a class="link" href="https://www.semianalysis.com/p/ai-capacity-constraints-cowos-and" target="_blank" rel="noopener"
>AI Capacity Constraints - CoWoS and HBM Supply Chain&lt;/a>&lt;/li>
&lt;li>[4] &lt;a class="link" href="https://www.semianalysis.com/p/amd-mi300-taming-the-hype-ai-performance" target="_blank" rel="noopener"
>AMD MI300 â€“ Taming The Hype â€“ AI Performance, Volume Ramp, Customers, Cost, IO, Networking, Software&lt;/a>&lt;/li>
&lt;li>[5] &lt;a class="link" href="https://www.anyscale.com/blog/continuous-batching-llm-inference" target="_blank" rel="noopener"
>How continuous batching enables 23x throughput in LLM inference while reducing p50 latency&lt;/a>&lt;/li>
&lt;li>[6] &lt;a class="link" href="https://twitter.com/dylan522p/status/1639791815778873346?s=20" target="_blank" rel="noopener"
>Clearly OpenAI does variable batch size based on usage volumeâ€¦â€¦&lt;/a>&lt;/li>
&lt;li>[7] &lt;a class="link" href="https://www.semianalysis.com/p/amazons-cloud-crisis-how-aws-will" target="_blank" rel="noopener"
>Amazonâ€™s Cloud Crisis: How AWS Will Lose The Future Of Computing&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Letâ€™s talk about my graduation design project -- SysMocap!</title><link>/en/p/bishe/</link><pubDate>Mon, 29 Aug 2022 00:00:00 +0000</pubDate><guid>/en/p/bishe/</guid><description>&lt;img src="/en/p/bishe/sysmocap.png" alt="Featured image of post Letâ€™s talk about my graduation design project -- SysMocap!" />&lt;p>The complete version of the thesis can be viewed on the WeChat public account &amp;ldquo;Xianfei&amp;rdquo;.&lt;/p>
&lt;p>The English version of this project has been accepted into IEEE ISMAR 2022-Adjunct.&lt;/p>
&lt;p>As of the time of writing, this project has received 1.5k Stars on GitHub, and the introductory video has received 27k likes and 11k coins on Bilibili.&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/xianfei/SysMocap/" target="_blank" rel="noopener"
>GitHub Repo&lt;/a>&lt;/p>
&lt;h2 id="introduction">Introduction&lt;/h2>
&lt;p>Four years of university life have flown by, during which I&amp;rsquo;ve learned a lot. The graduation project is the last opportunity to independently implement a project I&amp;rsquo;m interested in during my undergraduate studies. After discussing with my supervisor, I decided to build a video-driven virtual avatar system, or virtual anchor system. This allows users to choose their virtual avatars and control them.&lt;/p>
&lt;p>&lt;img src="../../../en/p/bishe/Picture1.jpg"
width="1320"
height="577"
srcset="../../../en/p/bishe/Picture1_huaddd65762d49a339faa9b38767bdeaf7_165064_480x0_resize_q60_box.jpg 480w, ../../../en/p/bishe/Picture1_huaddd65762d49a339faa9b38767bdeaf7_165064_1536x0_resize_q60_box.jpg 1536w"
loading="lazy"
class="gallery-image"
data-flex-grow="228"
data-flex-basis="549px"
>&lt;/p>
&lt;p>Of course, developing this system was a considerable challenge for me. It involved computer vision, computer graphics, desktop GUI development, network communication, and other areas. Before this, I had little experience with advanced technologies in posture assessment and motion capture. My supervisor provided me with a Kinect (a hardware device specifically used for motion capture) and introduced me to some open-source projects in this field. The goal was to drive the skeletal movements of a virtual avatar using open-source algorithms.&lt;/p>
&lt;p>I also learned about 3D graphic engines like Unreal Engine and Unity.&lt;/p>
&lt;h2 id="technical-approach">Technical Approach&lt;/h2>
&lt;p>During development, I researched and compared multiple existing algorithms. Many algorithms required specialized computer setups to run, which was a limitation. I wanted my system to be accessible for everyone, bringing the joy of technology to all.&lt;/p>
&lt;p>While browsing through open-source projects, I stumbled upon an article on Google&amp;rsquo;s TensorFlow Blog: &lt;a class="link" href="https://blog.tensorflow.org/2021/08/3d-pose-detection-with-mediapipe-blazepose-ghum-tfjs.html" target="_blank" rel="noopener"
>3D Pose Detection with MediaPipe BlazePose GHUM and TensorFlow.js&lt;/a>. It discussed a web-based 3D human joint detection method. This aligned perfectly with my vision for a highly portable and universal system. Using the Electron framework, I was able to develop a first-class cross-platform desktop GUI application.&lt;/p>
&lt;p>&lt;img src="../../../en/p/bishe/p2.png"
width="3314"
height="2120"
srcset="../../../en/p/bishe/p2_hu65dda13bc3c58b168e3a0269cbcb8752_364620_480x0_resize_q60_box_3.png 480w, ../../../en/p/bishe/p2_hu65dda13bc3c58b168e3a0269cbcb8752_364620_1536x0_resize_q60_box_3.png 1536w"
loading="lazy"
class="gallery-image"
data-flex-grow="156"
data-flex-basis="375px"
>&lt;/p>
&lt;p>Even better, this project, known as &lt;a class="link" href="https://github.com/yeemachine/kalidokit" target="_blank" rel="noopener"
>kalidokit&lt;/a>, provided source code, including its pipeline as illustrated below:&lt;/p>
&lt;p>&lt;img src="../../../en/p/bishe/kalidokit-pipeline.png"
width="2947"
height="1459"
srcset="../../../en/p/bishe/kalidokit-pipeline_hufd0f0c0c717966a1110ef505dc83a13f_501002_480x0_resize_q60_box_3.png 480w, ../../../en/p/bishe/kalidokit-pipeline_hufd0f0c0c717966a1110ef505dc83a13f_501002_1536x0_resize_q60_box_3.png 1536w"
loading="lazy"
class="gallery-image"
data-flex-grow="201"
data-flex-basis="484px"
>&lt;/p>
&lt;p>I then proceeded to study Mediapipe and kalidokit.&lt;/p>
&lt;h2 id="innovation">Innovation&lt;/h2>
&lt;p>While Mediapipe and kalidokit took me a huge step forward, they only supported VRM type virtual avatars. More common formats like fbx, glb/gltf were not supported.&lt;/p>
&lt;p>After implementing the tasks outlined in the project description, I wanted to add some practical and cutting-edge features. With virtual anchors gaining popularity, the virtual avatars generated by this software needed to be applied in real-time streaming. I designed an HTTP and WebSocket-based system for virtual avatar and action forwarding, and I set up a dedicated interface for OBS streaming software to stream to mainstream platforms.&lt;/p>
&lt;p>As we move closer to a metaverse era, AR/VR/MR (Augmented Reality, Virtual Reality, and Mixed Reality) will become mainstream. I designed a WebXR-based virtual avatar streaming solution. Users only need to access the system on WebXR-compatible devices to view virtual avatars and their actions in their surroundings in real-time. Imagine a science fiction scenario: you open an AR-enabled phone or put on VR/MR glasses, and the virtual avatar appears right in front of you.&lt;/p>
&lt;p>Main tasks include:&lt;/p>
&lt;ol>
&lt;li>Support for driving different types of virtual avatars.&lt;/li>
&lt;li>Develop a visually pleasing and easy-to-use GUI.&lt;/li>
&lt;li>OBS streaming support.&lt;/li>
&lt;li>AR/VR display support.&lt;/li>
&lt;/ol>
&lt;h2 id="challenges">Challenges&lt;/h2>
&lt;h3 id="driving-different-types-of-virtual-avatars">Driving Different Types of Virtual Avatars&lt;/h3>
&lt;p>Different virtual avatars often have different skeletal structures and naming conventions. One of the major challenges was learning about the skeletal systems of 3D models.&lt;/p>
&lt;p>&lt;img src="../../../en/p/bishe/p3.png"
width="2424"
height="742"
srcset="../../../en/p/bishe/p3_hu9d8998487cff97b03a102d0b6830cd95_1818310_480x0_resize_q60_box_3.png 480w, ../../../en/p/bishe/p3_hu9d8998487cff97b03a102d0b6830cd95_1818310_1536x0_resize_q60_box_3.png 1536w"
loading="lazy"
class="gallery-image"
data-flex-grow="326"
data-flex-basis="784px"
>&lt;/p>
&lt;p>This may be the first virtual anchor software that supports a variety of different virtual avatar formats and skeletal structures.&lt;/p>
&lt;h3 id="ar-display">AR Display&lt;/h3>
&lt;p>In my previous article about &amp;ldquo;AR Ice Cube,&amp;rdquo; I wanted to implement AR technology in this project.&lt;/p>
&lt;p>&lt;img src="../../../en/p/bishe/p4.png"
width="1878"
height="654"
srcset="../../../en/p/bishe/p4_hu6829a844c26691708e4953c673e7135e_935170_480x0_resize_q60_box_3.png 480w, ../../../en/p/bishe/p4_hu6829a844c26691708e4953c673e7135e_935170_1536x0_resize_q60_box_3.png 1536w"
loading="lazy"
class="gallery-image"
data-flex-grow="287"
data-flex-basis="689px"
>&lt;/p>
&lt;p>This may be the first virtual anchor software that can be used for AR/VR streaming.&lt;/p>
&lt;h2 id="conclusion">Conclusion&lt;/h2>
&lt;p>Through this project, I gained valuable knowledge in computer graphicsâ€”such as Euler angles, rotation matrices, quaternions, and spherical interpolation.&lt;/p>
&lt;p>A friend mentioned that she saw an article about my project on a WeChat public account she follows. Their review of my project was &amp;ldquo;mind-blowing&amp;rdquo; ğŸ˜‚&lt;/p>
&lt;p>The idea was to do something fun and unique. I wanted my project to be something that not everyone in my class or even my field could easily replicate.&lt;/p>
&lt;p>&lt;img src="../../../en/p/bishe/p5.png"
width="1274"
height="936"
srcset="../../../en/p/bishe/p5_hue35d2e5eda17a96103b7a7da494aa79b_559606_480x0_resize_q60_box_3.png 480w, ../../../en/p/bishe/p5_hue35d2e5eda17a96103b7a7da494aa79b_559606_1536x0_resize_q60_box_3.png 1536w"
loading="lazy"
class="gallery-image"
data-flex-grow="136"
data-flex-basis="326px"
>&lt;/p></description></item></channel></rss>